function authService($window){var self=this;self.parseJwt=function(token){var base64Url=token.split(".")[1],base64=base64Url.replace("-","+").replace("_","/");return JSON.parse($window.atob(base64))},self.saveToken=function(token){localStorage.setItem("jwtToken",token)},self.getToken=function(){return localStorage.getItem("jwtToken")},self.saveUser=function(user){2==user.user_group_id&&1==user.is_verified?user.is_verified_lawyer=!0:user.is_verified_lawyer=!1,localStorage.setItem("currentUser",JSON.stringify(user))},self.getUser=function(){return JSON.parse(localStorage.getItem("currentUser"))},self.isAuthed=function(){var token=self.getToken(),user=self.getUser();if(token&&user){var params=self.parseJwt(token);return Math.round((new Date).getTime()/1e3)<=params.exp}return!1},self.logout=function(){localStorage.removeItem("jwtToken"),localStorage.removeItem("currentUser")}}function userService($http,HOST,authService){var self=this;self.register=function(username,password,phonecode,account_type){return $http.post("http://"+HOST+"/register",{username:username,password:password,phonecode:phonecode,account_type:account_type}).then(function(res){layer.show("注册成功！"),$scope.user={},$scope.params={};var user=res.data?res.data.data:null;user&&(authService.saveUser(user),console.log("user:",user));var token=res.data?res.data.token:null;token&&(authService.saveToken(token),console.log("token:",token)),location.href="#/center",window.location.reload()})["catch"](function(response){if(console.error("Gists error",response.status,response.data),400===response.status){var errMsg=JSON.stringify(data.error_messages.username);layer.show(errMsg),layer.show("注册失败，请重新登录。")}})},self.login=function(username,password){return $http.post("http://"+HOST+"/login",{username:username,password:password}).then(function(res){var user=res.data?res.data.data:null;user&&(authService.saveUser(user),console.log("user:",user));var token=res.data?res.data.token:null;token&&(authService.saveToken(token),console.log("token:",token)),location.href="#/center",window.location.reload()})["catch"](function(response){console.error("Gists error",response.status,response.data),400===response.status&&layer.show("登录失败，账号或密码错误，请重新登录。")})},self.loginWithWx=function(code,state){return $http.post("http://"+HOST+"/loginWithWx",{code:code,state:state}).then(function(res){var user=res.data?res.data.data:null;alert(user.wx_openid),user&&(authService.saveUser(user),console.log("user:",user));var token=res.data?res.data.token:null;token&&(authService.saveToken(token),console.log("token:",token)),location.href="#/center",window.location.reload()})["catch"](function(response){console.error("Gists error",response.status,response.data),400===response.status&&layer.show("登录失败，账号或密码错误，请重新登录。")})}}function wxService(){var self=this;self.getWxAuthUrl=function($rootScope){var redirect_uri="http://devm.wdlst.com/#/wxauth",str="https://open.weixin.qq.com/connect/oauth2/authorize?";return str+="appid="+AppSettings.appId+"&",str+="redirect_uri="+encodeURIComponent(redirect_uri)+"&",str+="response_type=code&",str+="scope=snsapi_base&",str+="state=1",str+="#wechat_redirect"}}var layer=function(){function strUnicode2Ansi(asContents){for(var len1=asContents.length,temp="",i=0;len1>i;i++){var varasc=asContents.charCodeAt(i);if(0>varasc&&(varasc+=65536),varasc>127&&(varasc=UnicodeToAnsi(varasc)),varasc>255){var varlow=65280&varasc;varlow>>=8;var varhigh=255&varasc;temp+=String.fromCharCode(varlow)+String.fromCharCode(varhigh)}else temp+=String.fromCharCode(varasc)}return temp}return this.show=function(data){if(angular.isObject(data)&&(data=msg(data)),angular.isUndefined($("#hintShow").html())){var div=$("<div id='hintShow' style='width:100%;text-align:center;padding:12px 0px;background:black;opacity:0.7;color:#fff;position: fixed;top:0;left:0;display:none;z-index:9999;'>"+data+"</div>");div.appendTo($("body")).fadeIn("slow"),time=setInterval(function(){clearInterval(time),div.fadeOut("slow",function(){div.remove()})},2500),$("#hintShow").bind("click",function(){div.remove()})}},this.confirm=function(_msg,_callback){var warp="width: 60%;height:100px;background:#E8E8E8;color:#32A4E6;position:fixed;z-index:9999;top:30%;left:20%;text-align:center;border-radius:7px;",title="word-break:break-word;height: 36px;overflow:hidden;padding: 5px 5px;background:#fff;border-radius:5px;",canel="margin-top:15px;border-radius:7px;float:left;width:35%;margin-left:10%;background:#C7C7C7;padding: 4px 0px;color:#fff;",queding="margin-top:15px;float:right;width:35%;border-radius:7px;background:#439E35;padding: 4px 0px;color:#fff;margin-right:10%;",height=$(window).height(),shade=$("<div style='width:100%;height:"+height+"px;background:black;position:fixed;opacity:0.5;z-index:9998;top:0;left:0;'></div>"),div=$("<div style='"+warp+"'><div style='"+title+"'>"+_msg+"</div><div style='"+canel+"' id='canel'>取消</div><div style='"+queding+"' id='queding'>确定</div></div>");shade.appendTo($(document.body)),div.appendTo($(document.body)),$("#canel").bind("click",function(){shade.remove(),div.remove()}),$("#queding").bind("click",function(){shade.remove(),div.remove(),_callback()})},this.popup=function(divId){var height=$(window).height(),warp="width: 90%;height:"+(height-80)+"px;background:#fff;color:#32A4E6;position:fixed;z-index:9999;top:0;margin-left:5%;margin-right:5%;margin-top: 40px;border-radius:7px;overflow:scroll;";$("#"+divId).attr("style",warp).fadeIn("slow");var canel=$("<div id='embs_canel' style='font-size:20px;background:#ccc;color:#fff;border-radius:50%;width:30px;height:30px;line-height:30px;text-align:center;position:fixed;z-index:10000;top:20px;left:88%;'>X</div>"),shade=$("<div id='embs_shade' style='width:100%;height:"+height+"px;background:black;position:fixed;opacity:0.5;z-index:9998;top:0;left:0;'></div>");shade.appendTo($(document.body)),canel.appendTo($(document.body)),$("#embs_canel").bind("click",function(){canel.remove(),shade.remove(),$("#"+divId).fadeOut("slow")})},this.closePopup=function(divId){$("#embs_shade").remove(),$("#embs_canel").remove(),$("#"+divId).fadeOut("slow")},this.importPopup=function(_callback){var warp="width: 80%;height:200px;background:#E8E8E8;color:#32A4E6;position:fixed;z-index:9999;top:20%;left:10%;text-align:center;border-radius:7px;",title="word-break:break-word;height: 140px;overflow:hidden;padding: 5px 5px;background:#fff;border-radius:5px;",canel="margin-top:9px;border-radius:7px;float:left;width:35%;margin-left:10%;background:#C7C7C7;padding: 5px 0px;color:#fff;",queding="margin-top:9px;float:right;width:35%;border-radius:7px;background:#439E35;padding: 5px 0px;color:#fff;margin-right:10%;",height=$(window).height(),shade=$("<div style='width:100%;height:"+height+"px;background:black;position:fixed;opacity:0.5;z-index:9998;top:0;left:0;'></div>"),div=$("<div style='"+warp+"'><div style='"+title+"'><textarea style='width:95%;height:135px;border:1px solid #D4D4D4;font-size:16px;' id='import_textarea'></textarea></div><div style='"+canel+"' id='canel'>取消</div><div style='"+queding+"' id='queding'>确定</div></div>");shade.appendTo($(document.body)),div.appendTo($(document.body)),$("#canel").bind("click",function(){shade.remove(),div.remove()}),$("#queding").bind("click",function(){var val=$.trim($("#import_textarea").val());""==val||0==val.length?show("内容不能为空!"):(_callback(val),shade.remove(),div.remove())})},this.progress=function(_code){if(angular.isUndefined(_code)){if(angular.isUndefined($("#progress").html())){var div=$("<div id='progress' style='position: fixed;top:40%;margin-left:20%;margin-right:20%;display:none;z-index:9999;'><img src='images/global/loading.gif' width='100%' /></div>");div.appendTo($("body")).fadeIn("slow")}}else{var div=$("#progress");div.fadeOut("fast",function(){div.remove()})}},this.scroll=function(_callback,_callback2){$(window).bind("scroll",function(){$(window).scrollTop()+$(window).height()>=$(document).height()?_callback():$(window).scrollTop()<=0&&"function"==typeof _callback2&&_callback2()})},this.startIntegral=function(options){function index(obj,current){for(var i=0,length=current.length;length>i;i++)if(current[i]==obj)return i}function changeScreenEndFun(){if(this.page!=thisPage&&(thisPage=this.page,setTimeout(function(){document.querySelector(tab_title_ul+" > li.black").className="",document.querySelector(tab_title_ul+" > li:nth-child("+(thisPage+1)+")").className="black"},100),opacity)){var cpage=this.page,setTaboc=function(){setTimeout(function(){if($(change_screen_ul).children().eq(cpage).css({opacity:citypc}),1>=citypc)citypc+=.1,setTaboc();else for(var i=0;i<$(change_screen_ul).find("li").length;i++)i!=cpage&&(citypc=.5,$(change_screen_ul).children().eq(i).css({opacity:citypc}))},90)};setTaboc()}}function touchClick(obj,fun){function touEnd(e){var endX=e.changedTouches[0].clientX,endY=e.changedTouches[0].clientY;Math.abs(endX-start_x)<5&&Math.abs(endY-start_y)<5&&fun.call(obj,e),document.removeEventListener("touchend",touEnd,!1)}var start_x=0,start_y=0;obj.addEventListener("touchstart",function(e){start_x=e.touches[0].clientX,start_y=e.touches[0].clientY,document.addEventListener("touchend",touEnd,!1)})}var options=options||{},change_screen_div=options.change_screen_div||"#change_screen_div",change_screen_ul_li=options.change_screen_ul_li||".change_screen_ul_li",change_screen_ul=options.change_screen_ul||"#change_screen_ul",tab_title_ul=options.tab_title_ul||"#tab_title_ul",opacity=0!=options.opacity?!0:!1,thisPage=0;if($(change_screen_div).height($(window).height()-60),$(change_screen_ul_li).height($(window).height()-100),$(change_screen_ul).width(2*$(document).width()),opacity)for(var citypc=.5,i=0;i<$(change_screen_ul).find("li").length;i++)0!=i&&$(change_screen_ul).find("li").eq(i).css({opacity:citypc});var change_screen_ul=document.getElementById(change_screen_ul.substring(1)),slipjs=slip("page",change_screen_ul,{num:$(tab_title_ul).children().length,endFun:changeScreenEndFun}),ul=document.querySelector(tab_title_ul),li=document.querySelectorAll(tab_title_ul+"> li");touchClick(ul,function(e){if(ul.webkitMatchesSelector.call(e.target,"ul li")){var that=e.target,num=index(that,li);slipjs.toPage(num,300)}})},this.getUrlParam=function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(reg);return null!=r?decodeURI(r[2]):null},this.getParameters=function(locationUrl){var str,url=decodeURI(locationUrl),obj=new Object,index=url.lastIndexOf("?");if(-1!=index)if(url=url.slice(index+1,url.length),-1!=url.indexOf("&")){str=url.split("&");for(var i=0;i<str.length;i++){var str1=str[i].split("=");2==str1.length&&""!=str1[0]&&(obj[str1[0]]=str1[1])}}else str=url.split("="),2==str.length&&""!=str[0]&&(obj[str[0]]=str[1]);return obj},this.getParams=function(form){var params={};return $(form).find("input").each(function(obj){if("disabled"==$(this).attr("disabled"))return!0;if("disabled"==$(this).attr("data-disabled"))return!0;var name="",value="";return"radio"==$(this).attr("type")?(name=$(this).attr("name"),value=$(':radio[name="'+name+'"]:checked').val(),params[name]=value,!0):(name=$(this).attr("name"),value=$.trim($(this).val()),void(name&&(params[name]=value)))}),$(form).find("select").each(function(obj){if("disabled"==$(this).attr("disabled"))return!1;if("disabled"==$(this).attr("data-disabled"))return!0;if(""==$(this).val())return!0;var name=$(this).attr("name"),value=$(this).val();params[name]=value}),$(form).find("textarea").each(function(obj){if("disabled"==$.trim($(this).attr("data-disabled")))return!0;var name=$(this).attr("name"),value=$.trim($(this).val());params[name]=value}),params},this.stopDefault=function(e){return e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1,!1},this.base64code=function(input){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";input=strUnicode2Ansi(input);var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;do chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";while(i<input.length);return output},this.goBack=function(){window.history.back(),window.location.reload()},this.refresh=function(){window.location.reload()},this.goHome=function(){window.location.reload(),window.location.href="#/index"},this.msg=function(data){if(angular.isUndefined(data))return"服务器故障，请与管理员联系!";var _msg="";switch(data){case 401:_msg="账号过期，请重新登录。";break;default:_msg="错误代码: "+data}return layer.show(_msg)},this}(),lvtuanApp=angular.module("lvtuanApp.Ctrl",["ionic","ngSanitize","ngFileUpload","listModule","authModule","wxModule"]);lvtuanApp.constant("HOST",AppSettings.baseApiUrl),lvtuanApp.controller("MainController",["$rootScope","$scope","$state","$location","userService","authService","$http",function($rootScope,$scope,$state,$location,userService,authService,$http){var self=this;self.login=function(){userService.login(self.username,self.password)},self.register=function(){},self.logout=function(){authService.logout()},self.isAuthed=function(){return authService.isAuthed?authService.isAuthed():!1},$scope.currentUser=authService.getUser(),self.getLocation=function(){$scope.currentUser&&($scope.currentUser.city_id="广东",$scope.currentUser.region_id="深圳市",authService.saveUser($scope.currentUser)),$http.get("http://"+$rootScope.hostName+"/common/wxconfig").success(function(data){data&&(data.debug=!1,wx.config(data))}),wx.ready(function(){wx.getLocation({success:function(res){$http.get("http://"+$rootScope.hostName+"/common/addressCode/"+res.latitude+","+res.longitude).success(function(data){data&&($scope.currentUser.city_id=data.city_id,$scope.currentUser.region_id=data.region_id,authService.saveUser($scope.currentUser))})},cancel:function(res){alert("用户拒绝授权获取地理位置")}})})},self.getLocation()}]),lvtuanApp.controller("HeaderController",["$scope","$location",function($scope,$location){$scope.isActives=function(route){return 0==$location.path().indexOf(route)},console.log("HomeTabCtrl")}]),lvtuanApp.directive("hideTabs",["$rootScope",function($rootScope){return{restrict:"A",link:function($scope,$el){$rootScope.hideTabs="tabs-item-hide",$scope.$on("$destroy",function(){$rootScope.hideTabs=""})}}}]),lvtuanApp.directive("showTabs",["$rootScope",function($rootScope){return{restrict:"AE",link:function($scope,$el){$rootScope.hideTabs="",$scope.$on("$destroy",function(){$rootScope.hideTabs="tabs-item-hide"})}}}]),lvtuanApp.directive("star",function(){return{template:'<ul class="rating" ng-mouseleave="leave()"><li ng-repeat="star in stars" ng-class="star" ng-click="click($index + 1)" ng-mouseover="over($index + 1)">★</li></ul>',scope:{ratingValue:"=",max:"=",readonly:"@",onHover:"=",onLeave:"="},controller:["$scope",function($scope){$scope.ratingValue=$scope.ratingValue||0,$scope.max=$scope.max||5,$scope.click=function(val){$scope.readonly&&"true"===$scope.readonly||($scope.ratingValue=val)},$scope.over=function(val){$scope.onHover(val)},$scope.leave=function(){$scope.onLeave()}}],link:function(scope,elem,attrs){elem.css("text-align","center");var updateStars=function(){scope.stars=[];for(var i=0;i<scope.max;i++)scope.stars.push({filled:i<scope.ratingValue})};updateStars(),scope.$watch("ratingValue",function(oldVal,newVal){newVal&&updateStars()}),scope.$watch("max",function(oldVal,newVal){newVal&&updateStars()})}}}),lvtuanApp.constant("$ionicLoadingConfig",{content:'<ion-spinner icon="android"></ion-spinner>',animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0}),lvtuanApp.controller("ionicNavBarDelegateCtrl",["$state","$timeout","$http","$location",function($state,$timeout,$http,$location){$timeout(function(){location.href="#/index"},2e3,[!1])}]),lvtuanApp.controller("indexCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/lawyer/list_lawyers?is_recommended=1",$scope),$scope.mylvteam=function(){location.href="#/mylvteam"}}]),lvtuanApp.controller("loginCtrl",["$state","$scope","$rootScope","$http","userService",function($state,$scope,$rootScope,$http,userService){function checkvaldata(user){if(""==user.username)return layer.show("请输入手机号码或者邮箱！"),!1;if(user.username.match(format_mobile)){if(null==user.username.match(format_mobile))return layer.show("请输入正确的手机号码!"),!1}else if(null==user.username.match(format_email))return layer.show("请输入正确邮箱账号!"),!1;return!0}var format_email=/^(([0-9a-zA-Z]+)|([0-9a-zA-Z]+[_.0-9a-zA-Z-]*[0-9a-zA-Z]+))@([a-zA-Z0-9-]+[.])+([a-zA-Z]{2} |net|NET|com|COM|gov|GOV|mil|MIL|org|ORG|edu|EDU|int|INT|cn|CN)$/,format_mobile=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;$scope.submit=function(user){checkvaldata(user)&&userService.login(user.username,user.password)}}]),lvtuanApp.controller("registerCtrl",["$scope","$rootScope","$http","userService","authService",function($scope,$rootScope,$http,userService,authService){$scope.phonecode=function(phone){var param="phone="+phone;$http.post("http://"+$rootScope.hostName+"/send-code?"+param).success(function(data){layer.show("验证码已发送到您的手机！")})},$scope.submit=function(user){$scope.params={},user.username&&($scope.params.username=user.username),user.phonecode&&($scope.params.phonecode=user.phonecode),user.password&&($scope.params.password=user.password),$http.post("http://"+$rootScope.hostName+"/register",{username:$scope.params.username,password:$scope.params.password,phonecode:$scope.params.phonecode,account_type:"phone"}).success(function(data){layer.show("注册成功！"),$scope.user={},$scope.params={};var user_data=data?data.data:null;user_data&&(authService.saveUser(user_data),console.log("user:",user_data));var token=data?data.token:null;token&&(authService.saveToken(token),console.log("JWT:",token)),1==user.isCheck?location.href="#/becomelawyer":location.href="#/center"})}}]),lvtuanApp.controller("resetpwdCtrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){$scope.user={},$scope.save=function(user){return user.old_password==user.new_password&&user.old_password==user.new_password_retype&&user.new_password==user.new_password_retype?(layer.show("修改密码不能和初始密码一样！"),!1):user.new_password.length!=user.new_password_retype.length?(layer.show("重置密码的长度不一致！"),!1):user.new_password!=user.new_password_retype?(layer.show("两次输入的密码不一致！"),!1):($http.post("http://"+$rootScope.hostName+"/center/reset_pass",$scope.user).success(function(data){layer.show("修改成功！"),$scope.user={},location.href="#/login",window.location.reload()}),!0)}}]),lvtuanApp.controller("wxAuthCtrl",["$scope","$stateParams","wxService","userService",function($scope,$stateParams,wxService,userService){userService.loginWithWx($stateParams.code,$stateParams.state)}]),lvtuanApp.controller("wxLoginCtrl",["$scope","$http","$rootScope","wxService",function($scope,$http,$rootScope,wxService){window.location.replace(wxService.getWxAuthUrl())}]),lvtuanApp.controller("groupCtrl",["$scope","$http","$state","$rootScope",function($scope,$http,$state,$rootScope){$scope.jumplogin=function(){console.info($rootScope.is_lawyer),location.href="#/login",window.location.reload()}}]),lvtuanApp.controller("groupListCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/group/list/mine",$scope)}]),lvtuanApp.controller("groupTeleviseCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/microblog/list/all",$scope),$scope.likes=function(id,index){$http.post("http://"+$rootScope.hostName+"/like",{item_type:"post",item_id:id}).success(function(data){console.info(data);var itmes=data.data;$scope.televise[index].post_extra.likes_count=itmes.likes_count,layer.show("点赞成功！")})}}]),lvtuanApp.controller("groupAttentionCtrl",["$scope","$http","$state","$rootScope",function($scope,$http,$state,$rootScope){function getparamq(){var param=layer.getParams("#search_form");getUrlq(param)}function getUrlq(param){var url="";url+=param.q?"http://"+$rootScope.hostName+"/group/recommend?q="+param.q+"&page="+page++:"http://"+$rootScope.hostName+"/group/recommend?page="+page++,$http.get(url).success(function(data){return data&&data.data&&data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,void($scope.recommendeds=$scope.recommendeds.concat(data.data))):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}var page=1;$scope.moredata=!0,$scope.recommendeds=[],$scope.search=function(){page=1,$scope.recommendeds=[],getparamq()},$scope.doRefresh=function(){page=1,$scope.recommendeds=[],getparamq()},$scope.loadMore=function(){getparamq()},$scope.groupjoin=function(id,index){page=1;var id=id;$http.post("http://"+$rootScope.hostName+"/group/"+id+"/join?page="+page++,{},{cache:!0,headers:{Accept:"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){return data&&data.data?($scope.recommendeds.splice(index,1),void layer.show("已关注 加入成功！")):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}}]),lvtuanApp.controller("groupviewCtrl",["$scope","$http","$state","$rootScope","$stateParams",function($scope,$http,$state,$rootScope,$stateParams){function getuserpwd(itmes){var name=$("#user_name").val(),pwd=$("#user_password").val();return null==name||null==pwd?!1:name==itmes.user_id&&pwd==itmes.pwd?!0:void 0}console.info("圈子详情"),$scope.user_name="",$scope.user_password="",$("#user_name").val(),$("#user_password").val(),$http.get("http://"+$rootScope.hostName+"/group/"+$stateParams.id+"/chat").success(function(data){if(data&&data.data){console.info("圈子详情",data.data);var itmes=data.data;$scope.user_name=itmes.user_id,$scope.user_password=itmes.pwd,$scope.id=itmes.id,localStorage.setItem("goup_id",JSON.stringify($scope.id)),localStorage.setItem("easemob_id",JSON.stringify(itmes.easemob_id));var time=null;time=setInterval(function(){1==getuserpwd(itmes)&&(clearInterval(time),login())},2e3)}}),$scope.site=function(){location.href="#/group/site/"+$scope.id,window.location.reload()}}]),lvtuanApp.controller("groupsiteCtrl",["$scope","$http","$state","$rootScope","$stateParams","$timeout","$ionicPopup","Upload",function($scope,$http,$state,$rootScope,$stateParams,$timeout,$ionicPopup,Upload){console.info("圈子设置"),$scope.id=JSON.parse(localStorage.getItem("goup_id")),$http.get("http://"+$rootScope.hostName+"/group/"+$scope.id+"/detail").success(function(data){data&&data.data&&(console.info("圈子设置",data.data),$scope.group=data.data,$scope.group_name=$scope.group.group_name,$scope.is_mine=$scope.group.is_mine,$scope.file=$scope.group.group_avatar)}),$scope.del=function(id,index){$http.get("http://"+$rootScope.hostName+"/group/"+$scope.id+"/removemember/"+id,{cache:!0,headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){layer.show(data.data),$scope.group.members.splice(index,1)})},$scope.logoutGroup=function(){var confirmPopup=$ionicPopup.confirm({title:"确定解散该群？",cancelText:"取消",okText:"确认"});confirmPopup.then(function(res){return res?void $http.get("http://"+$rootScope.hostName+"/group/"+$scope.id+"/dissolution",{cache:!0,headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){layer.show(data.data),location.href="#/group/list",window.location.reload()}):!1})},$scope.edit=function(id){var params=layer.getParams("#myForm");""==params.group_name?layer.show("圈子名称不能为空！"):$http.post("http://"+$rootScope.hostName+"/group/"+$stateParams.id+"/edit",{group_name:params.group_name,group_avatar:params.group_avatar},{headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){layer.show("修改成功！")})},$scope.uploadFiles=function(group_avatar){group_avatar&&$scope.upload(group_avatar)},$scope.upload=function(group_avatar){Upload.upload({url:"http://"+$rootScope.hostName+"/group/uploadImage",data:{group_avatar:group_avatar}}).then(function(response){var file_path="http://"+$rootScope.hostName+"/"+response.data.data;$scope.file=file_path,$timeout(function(){$scope.result=response.data})},function(response){if(response.status>0){var errorMsg=response.status+": "+response.data;console.info("errorMsg",errorMsg),layer.show(errorMsg)}},function(evt){var progres=parseInt(100*evt.loaded/evt.total);$scope.progress=progres})},$scope.quitGroup=function(){var confirmPopup=$ionicPopup.confirm({title:"确定退出该群？",cancelText:"取消",okText:"确认"});confirmPopup.then(function(res){return res?void $http.get("http://"+$rootScope.hostName+"/group/"+$scope.id+"/quit").success(function(data){layer.show(data.data),location.href="#/group/list",window.location.reload()}):!1})}}]),lvtuanApp.controller("groupaddCtrl",["$scope","$http","$state","$rootScope","$stateParams",function($scope,$http,$state,$rootScope,$stateParams){console.info("添加成员"),console.info($stateParams.id);var page=1;$scope.moredata=!0,$scope.items=[],$scope.doRefresh=function(){page=1,$scope.items=[],$scope.loadMore()},$scope.loadMore=function(){$http.get("http://"+$rootScope.hostName+"/group/"+$stateParams.id+"/addmember").success(function(data){return data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,void($scope.items=$scope.items.concat(data.data))):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})},Array.prototype.remove=function(index){if(isNaN(index)||index>this.length)return!1;for(var i=0,n=0;i<this.length;i++)this[i]!=this[index]&&(this[n++]=this[i]);this.length-=1},$scope.selIds=[],$scope.checkItem=function(obj,id){if(0==obj){var index;angular.forEach($scope.selIds,function(val,key){val==id&&(index=key)}),$scope.selIds.remove(index,index)}else $scope.selIds.push(id)},$scope.createSubmit=function(){$http.post("http://"+$rootScope.hostName+"/group/"+$stateParams.id+"/addmember",{members:$scope.selIds}).success(function(data){location.href="#/group/site/"+$stateParams.id,window.location.reload()})}}]),lvtuanApp.controller("groupcreateCtrl",["$scope","$http","$state","$rootScope","$timeout","Upload",function($scope,$http,$state,$rootScope,$timeout,Upload){console.info("创建圈子");var page=1;$scope.moredata=!0,$scope.items=[],$scope.doRefresh=function(){page=1,$scope.items=[],$scope.loadMore()},$scope.loadMore=function(){$http.get("http://"+$rootScope.hostName+"/group/create?page="+page++,{cache:!0,headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){return data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,void($scope.items=$scope.items.concat(data.data))):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})},Array.prototype.remove=function(index){if(isNaN(index)||index>this.length)return!1;for(var i=0,n=0;i<this.length;i++)this[i]!=this[index]&&(this[n++]=this[i]);this.length-=1},$scope.selIds=[],$scope.checkItem=function(obj,id){if(0==obj){var index;angular.forEach($scope.selIds,function(val,key){val==id&&(index=key)}),$scope.selIds.remove(index,index)}else $scope.selIds.push(id)},$scope.createSubmit=function(){var members=$scope.selIds,params=getParams("#createGroup_form");return""==params.group_name?(layer.show("请输入圈子名称!"),!1):""==params.group_avatar?(layer.show("请上传圈子头像!"),!1):($http.post("http://"+$rootScope.hostName+"/group/store",{group_name:params.group_name,group_avatar:params.group_avatar,members:members}).success(function(data){layer.show("创建成功！"),$scope.selIds={},$scope.file={},$(":input","#questions_form").not("textarea :submit, :reset, :hidden").val(""),location.href="#/group/list",window.location.reload()}),!0)},$scope.uploadFiles=function(group_avatar){group_avatar&&$scope.upload(group_avatar)},$scope.upload=function(group_avatar){Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/group/uploadImage",data:{group_avatar:group_avatar}}).then(function(response){var file_path="http://"+$rootScope.hostName+"/"+response.data.data;$scope.file=file_path,$timeout(function(){$scope.result=response.data})},function(response){if(response.status>0){var errorMsg=response.status+": "+response.data;console.info("errorMsg",errorMsg),layer.show(errorMsg)}},function(evt){var progres=parseInt(100*evt.loaded/evt.total);$scope.progress=progres})}}]),lvtuanApp.controller("televisecreateCtrl",["$scope","$http","$state","$rootScope","$timeout","Upload",function($scope,$http,$state,$rootScope,$timeout,Upload){console.info("创建广播"),$scope.file=[],$scope.srcfile=[],$scope.uploadFiles=function(files,errFiles){if(console.info(files,errFiles),files){if(files.length>9)return layer.show("最多只能上传9张照片！"),!1;$scope.files=files,$scope.errFiles=errFiles,angular.forEach(files,function(file){file.upload=Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/microblog/uploadImage",data:{microBlogImage:file}}),file.upload.then(function(response){var src_url=response.data.data.src_url,src=response.data.data.src;src&&($scope.file.push(src_url),$scope.srcfile.push(src)),$timeout(function(){file.result=response.data})},function(response){response.status>0&&($scope.errorMsg=response.status+": "+response.data),layer.show($scope.errorMsg)},function(evt){file.progress=Math.min(100,parseInt(100*evt.loaded/evt.total))})})}},$scope.del=function(index){$scope.file.splice(index,1),$scope.srcfile.splice(index,1)},$scope.createSubmit=function(){var params=getParams("#myForm");return""==params.content?(layer.show("请输入你的广播!"),!1):($http.post("http://"+$rootScope.hostName+"/microblog/create",{content:params.content,file_paths:$scope.srcfile}).success(function(data){console.log(data.data),layer.show("提交成功！"),$(":input","#myForm").not("textarea :submit, :reset, :hidden").val(""),$scope.file=[],$scope.srcfile=[],location.href="#/broadcast/view/"+data.data.id}),!0)}}]),lvtuanApp.controller("broadcastviewCtrl",["$scope","$http","$state","$rootScope","$stateParams","$ionicPopup",function($scope,$http,$state,$rootScope,$stateParams,$ionicPopup){$http.get("http://"+$rootScope.hostName+"/microblog/"+$stateParams.id+"/view").success(function(data){console.info("广播详情",data.data),$scope.items=data.data}),$scope.likes=function(id){$http.post("http://"+$rootScope.hostName+"/like",{item_type:"post",item_id:id}).success(function(data){var like=data.data;$scope.items.post_extra.likes_count=like.likes_count,layer.show("点赞成功！")})},$scope.share=function(id){$scope.id=id,$scope.data={};var myPopup=$ionicPopup.show({template:'<textarea ng-model="data.content" name="content" rows="5" placeholder="想说些什么呢？..."></textarea>',title:"分享",scope:$scope,buttons:[{text:"取消"},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){return $scope.data.content}}]});myPopup.then(function(res){$scope.content=res,$http.post("http://"+$rootScope.hostName+"/microblog/forward",{content:$scope.content,parent_id:$scope.id}).success(function(data){console.info(data),layer.show("分享成功！")})})},$scope.comments=function(id){$scope.id=id,$scope.data={};var myPopup=$ionicPopup.show({template:'<textarea ng-model="data.comments" name="comments" rows="5" placeholder="想说些什么呢？..."></textarea>',title:"评论",scope:$scope,buttons:[{text:"取消"},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){return $scope.data.comments}}]});myPopup.then(function(res){void 0!=res?($scope.comments=res,$http.post("http://"+$rootScope.hostName+"/microblog/"+id+"/comment/create",{content:$scope.comments,post_id:id}).success(function(data){
console.info(data),layer.show("评论成功！")})):myPopup.close()})}}]),lvtuanApp.controller("knowledgesCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/news/list_news",$scope)}]),lvtuanApp.controller("documentsCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/knowledge/article/list_articles",$scope)}]),lvtuanApp.controller("casesCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/case/list_case",$scope)}]),lvtuanApp.controller("knowledgeViewCtrl",["$scope","$http","$rootScope","$stateParams","$ionicPopup","$ionicPopup","$timeout",function($scope,$http,$rootScope,$stateParams,$ionicPopup,$ionicPopup,$timeout){function init(){var url="http://"+$rootScope.hostName+"/knowledge/"+$stateParams.id+"/view";$http.get(url).success(function(data){console.info(data.data),$scope.items=data.data,sessionStorage.setItem("comments_count",JSON.stringify($scope.items.comments_count))})}init(),$scope.likes=function(id){$http.post("http://"+$rootScope.hostName+"/like",{item_type:"article",item_id:id},{headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){console.info(data);var itmes=data.data;$scope.items.likes_count=itmes.likes_count,layer.show("点赞成功！")})},$scope.collects=function(id){$http.post("http://"+$rootScope.hostName+"/collect",{collect_type:3,item_id:id},{headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){var itmes=data.data;$scope.items.collects_count=itmes,layer.show("收藏成功！")})},$scope.comments=function(id){$scope.id=id,$scope.data={};var myPopup=$ionicPopup.show({template:'<textarea ng-model="data.evaluate_comment" name="evaluate_comment" rows="5" placeholder="想说些什么呢？..."></textarea>',title:"评论",scope:$scope,buttons:[{text:"取消"},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){if($scope.data.evaluate_comment){if(!($scope.data.evaluate_comment.length>140))return $scope.data.evaluate_comment;layer.show("内容字数不能大于140字符！"),e.preventDefault()}else layer.show("内容不能为空！"),e.preventDefault()}}]});myPopup.then(function(res){void 0!=res?($scope.evaluate_comment=res,$http.post("http://"+$rootScope.hostName+"/article/"+id+"/comment",{evaluate_comment:$scope.evaluate_comment,item_id:id}).success(function(data,status,headers,config){$scope.comment=data.data,$scope.items.comments_count=$scope.comment.comments_count,sessionStorage.setItem("comments_count",JSON.stringify($scope.items.comments_count)),layer.show("评论成功！")})):myPopup.close()})}}]),lvtuanApp.controller("commentsViewCtrl",["$scope","$http","$rootScope","$stateParams","$ionicPopup","$ionicPopup","listHelper",function($scope,$http,$rootScope,$stateParams,$ionicPopup,$ionicPopup,listHelper){$scope.comments_count=JSON.parse(sessionStorage.getItem("comments_count")),listHelper.bootstrap("/article/"+$stateParams.id+"/comment/list",$scope),console.info("/article/"+$stateParams.id+"/comment/list"),$scope.comments=function(){$scope.data={};var myPopup=$ionicPopup.show({template:'<textarea ng-model="data.evaluate_comment" name="evaluate_comment" rows="5" placeholder="想说些什么呢？..."></textarea>',title:"评论",scope:$scope,buttons:[{text:"取消"},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){if($scope.data.evaluate_comment){if(!($scope.data.evaluate_comment.length>140))return $scope.data.evaluate_comment;layer.show("内容字数不能大于140字符！"),e.preventDefault()}else layer.show("内容不能为空！"),e.preventDefault()}}]});myPopup.then(function(res){void 0!=res?($scope.evaluate_comment=res,$http.post("http://"+$rootScope.hostName+"/article/"+$stateParams.id+"/comment",{evaluate_comment:$scope.evaluate_comment,item_id:$stateParams.id}).success(function(data,status,headers,config){$scope.comment=data.data,$scope.items=$scope.items.concat($scope.comment),$scope.comments_count=$scope.comment.comments_count,sessionStorage.setItem("comments_count",JSON.stringify($scope.comment.comments_count)),layer.show("评论成功！")})):myPopup.close()})}}]),lvtuanApp.controller("centerCtrl",["$scope","$http","$rootScope","$ionicPopup","$timeout","authService",function($scope,$http,$rootScope,$ionicPopup,$timeout,authService){var currentUser=authService.getUser();$scope.currentUser=currentUser,currentUser.is_verified_lawyer?$http.get("http://"+$rootScope.hostName+"/center/lawyer/info").success(function(data){return data&&data.data?void($scope.items=data.data):(layer.show("暂无数据！"),!1)}):$http.get("http://"+$rootScope.hostName+"/center/customer/info").success(function(data){return data&&data.data?void($scope.items=data.data):(layer.show("暂无数据！"),!1)}),$scope.invitefriend=function(){$scope.data={};$ionicPopup.show({templateUrl:"popup-invitefriend-template.html",title:"邀请好友",scope:$scope,buttons:[{text:"Cancel"}]})}}]),lvtuanApp.controller("infoCtrl",["$scope","$http","$rootScope","$timeout","Upload","authService",function($scope,$http,$rootScope,$timeout,Upload,authService){var currentUser=authService.getUser();1==currentUser.user_group_id||2==currentUser.user_group_id&&0==currentUser.is_verified?$http.get("http://"+$rootScope.hostName+"/center/customer/info").success(function(data){return data&&data.data?($scope.items=data.data,$scope.file=$scope.items.user.avatar,$scope.user={realname:$scope.items.user.realname,phone:$scope.items.user.phone,email:$scope.items.user.email},void 0):(layer.show("暂无数据！"),!1)}):$http.get("http://"+$rootScope.hostName+"/center/lawyer/info").success(function(data){return data&&data.data?($scope.items=data.data,$scope.file=$scope.items.user.avatar,$scope.user={realname:$scope.items.user.realname,phone:$scope.items.user.phone,email:$scope.items.user.email},void 0):(layer.show("暂无数据！"),!1)}),$scope.uploadFiles=function(avatar,id){avatar&&$scope.upload(avatar,id)},$scope.upload=function(avatar,id){Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/file/upload/user",data:{upload_file:avatar,user_id:id}}).then(function(response){var file_path="http://"+$rootScope.hostName+"/"+response.data.data.file_path;$scope.file=file_path,$timeout(function(){$scope.result=response.data})},function(response){if(response.status>0){var errorMsg=response.status+": "+response.data;console.info("errorMsg",errorMsg),layer.show(errorMsg)}},function(evt){var progres=parseInt(100*evt.loaded/evt.total);$scope.progress=progres})},$scope.submit=function(){var params=layer.getParams("#myForm");console.info(params),$http.post("http://"+$rootScope.hostName+"/center/customer/info",params).success(function(data){data&&data.data&&($scope.items=data.data,layer.show("提交成功！"))})}}]),lvtuanApp.controller("listscoresCtrl",["$scope","listHelper",function($scope,listHelper){$scope.rows_per_page=20,listHelper.bootstrap("/center/score/list_scores",$scope)}]),lvtuanApp.controller("messagesCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/letter/sys",$scope)}]),lvtuanApp.controller("viewMessageCtrl",["$scope","$http","$rootScope","$interval","$stateParams",function($scope,$http,$rootScope,$interval,$stateParams){var id=$stateParams.id,url="http://"+$rootScope.hostName+"/letter/sys-letters/"+id;$http.get(url).success(function(data){data&&data.data&&($scope.item=data.data)})}]),lvtuanApp.controller("collectCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/collect",$scope)}]),lvtuanApp.controller("commentCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/blog/reply",$scope)}]),lvtuanApp.controller("followedCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/mylawyer/followed",$scope)}]),lvtuanApp.controller("becomelawyerCtrl",["$scope","$http","$rootScope","$ionicActionSheet","$timeout","$stateParams","Upload","authService",function($scope,$http,$rootScope,$ionicActionSheet,$timeout,$stateParams,Upload,authService){function getpositionsParm(parm){for(var i=0;i<$scope.positions.length;i++)if(parm==$scope.positions[i].key){$scope.position=$scope.positions[i];break}}function getProvince(){getProvinceParm(null)}function getProvinceParm(parm){$http.get("http://"+$rootScope.hostName+"/area/province").success(function(data){if(console.info(data.data),$scope.provinces=data.data,parm)for(var i=0;i<$scope.provinces.length;i++)if(parm==JSON.stringify($scope.provinces[i].key)){$scope.province=$scope.provinces[i];break}})}function getCityParm(province,parm){return null==province&&null==parm?!1:void $http.get("http://"+$rootScope.hostName+"/area/"+province+"/city").success(function(data){if($scope.citys=data.data,parm)for(var i=0;i<$scope.citys.length;i++)if(parm==JSON.stringify($scope.citys[i].key)){$scope.city=$scope.citys[i];break}})}function getDistrictParm(city,parm){return null==city&&null==parm?!1:void $http.get("http://"+$rootScope.hostName+"/area/"+city+"/district").success(function(data){if($scope.districts=data.data,parm)for(var i=0;i<$scope.districts.length;i++)if(parm==JSON.stringify($scope.districts[i].key)){$scope.district=$scope.districts[i];break}})}function getPractisePeriods(){getPractisePeriodsParm(null)}function getPractisePeriodsParm(parm){$http.get("http://"+$rootScope.hostName+"/lawyer/practiseperiods").success(function(data){if($scope.periods=data.data,parm)for(var i=0;i<$scope.periods.length;i++)if(parm==$scope.periods[i].key){$scope.practice_period=$scope.periods[i];break}})}function getPractisePeriods(){getPractisePeriodsParm(null)}function getPractisePeriodsParm(parm){$http.get("http://"+$rootScope.hostName+"/lawyer/practiseperiods").success(function(data){if($scope.periods=data.data,parm)for(var i=0;i<$scope.periods.length;i++)if(parm==$scope.periods[i].key){$scope.practice_period=$scope.periods[i];break}})}function getWorkscopes(){getWorkscopesParm(null)}function getWorkscopesParm(parm){$http.get("http://"+$rootScope.hostName+"/lawyer/workscopes").success(function(data){if($scope.workscopes_one=data.data,sessionStorage.setItem("workscopes_one",JSON.stringify($scope.workscopes_one)),parm)for(var i=0;i<$scope.workscopes_one.length;i++)if(parm==$scope.workscopes_one[i].key){$scope.workscope_one=$scope.workscopes_one[i];break}})}function getworkscopes_oneParm(workscope,parm){if($scope.workscopes_two=JSON.parse(sessionStorage.getItem("workscopes_one")),workscope){for(var index,i=0;i<$scope.workscopes_two.length;i++)workscope.key==$scope.workscopes_two[i].key&&(index=i,$scope.workscopes_two.remove(index));if($scope.workscopes_two=$scope.workscopes_two,sessionStorage.setItem("workscopes_two",JSON.stringify($scope.workscopes_two)),parm)for(var i=0;i<$scope.workscopes_two.length;i++)if(parm==$scope.workscopes_two[i].key){$scope.workscope_two=$scope.workscopes_two[i];break}}}function getworkscopes_twoParm(workscope,parm){if($scope.workscopes_three=JSON.parse(sessionStorage.getItem("workscopes_two")),workscope){for(var index,i=0;i<$scope.workscopes_three.length;i++)workscope.key==$scope.workscopes_three[i].key&&(index=i,$scope.workscopes_three.remove(index));if($scope.workscopes_three=$scope.workscopes_three,sessionStorage.setItem("workscopes_three",JSON.stringify($scope.workscopes_three)),parm)for(var i=0;i<$scope.workscopes_three.length;i++)if(parm==$scope.workscopes_three[i].key){$scope.workscope_three=$scope.workscopes_three[i];break}}}getProvince(),getWorkscopes(),getPractisePeriods(),$scope.sexs=[{key:"male",value:"男"},{key:"female",value:"女"}],$scope.positions=[{key:"lawyer",value:"律师"},{key:"senior_lawyer",value:"高级律师"},{key:"partner",value:"合伙人"}];var currentUser=authService.getUser();2==currentUser.user_group_id&&1==currentUser.is_verified&&$http.get("http://"+$rootScope.hostName+"/center/lawyer/info").success(function(data){data&&data.data&&($scope.items=data.data,$scope.file_2=$scope.items.user.avatar,$scope.file_3=$scope.items.user.lawyer.bg_image,$scope.province=$scope.items.user.province,$scope.city=$scope.items.user.city,$scope.district=$scope.items.user.district,getProvinceParm($scope.province),getCityParm($scope.province,$scope.city),getDistrictParm($scope.city,$scope.district),$scope.address=$scope.items.user.address,$scope.practice_period=$scope.items.user.lawyer.practice_period,getPractisePeriodsParm($scope.practice_period),$scope.position=$scope.items.user.lawyer.position,getpositionsParm($scope.position),void 0!=$scope.items.user.lawyer.work_scope[0]&&($scope.workscope_one=$scope.items.user.lawyer.work_scope[0].key),void 0!=$scope.items.user.lawyer.work_scope[1]&&($scope.workscope_two=$scope.items.user.lawyer.work_scope[1].key),void 0!=$scope.items.user.lawyer.work_scope[2]&&($scope.workscope_three=$scope.items.user.lawyer.work_scope[2].key),getWorkscopesParm($scope.workscope_one),getworkscopes_oneParm($scope.workscope_one,$scope.workscope_two),getworkscopes_twoParm($scope.workscope_two,$scope.workscope_three),$scope.phonereplyfee=$scope.items.user.lawyer.phone_reply_fee,$scope.textreplyfee=$scope.items.user.lawyer.text_reply_fee,$scope.introduce=$scope.items.user.lawyer.introduce,$scope.experience=$scope.items.user.lawyer.experience,$scope.law_cases=$scope.items.user.lawyer.law_cases)}),$scope.getCity=function(province){getCityParm(province,null)},$scope.getDistrict=function(city){getDistrictParm(city,null)},Array.prototype.remove=function(index){if(isNaN(index)||index>this.length)return!1;for(var i=0,n=0;i<this.length;i++)this[i]!=this[index]&&(this[n++]=this[i]);this.length-=1},$scope.getworkscopes_one=function(workscope){getworkscopes_oneParm(workscope,null)},$scope.getworkscopes_two=function(workscope){getworkscopes_twoParm(workscope,null)},$scope.uploadFiles=function(license_file,index){Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/file/upload/user",data:{upload_file:license_file,user_id:$rootScope.user_id}}).then(function(response){var file_path="http://"+$rootScope.hostName+"/"+response.data.data.file_path;1==index&&($scope.file_1=file_path),2==index&&($scope.file_2=file_path),3==index&&($scope.file_3=file_path),4==index&&($scope.file_4=file_path),$timeout(function(){$scope.result=response.data})},function(response){if(response.status>0){var errorMsg=response.status+": "+response.data;1==index&&(console.info("errorMsg_1",errorMsg),layer.show(errorMsg)),2==index&&(console.info("errorMsg_2",errorMsg),layer.show(errorMsg)),3==index&&(console.info("errorMsg_3",errorMsg),layer.show(errorMsg)),4==index&&(console.info("errorMsg_4",errorMsg),layer.show(errorMsg))}},function(evt){var progres=parseInt(100*evt.loaded/evt.total);1==index&&($scope.progress_1=progres),2==index&&($scope.progress_2=progres),3==index&&($scope.progress_3=progres),4==index&&($scope.progress_4=progres)})},$scope.sever=function(){$scope.user=layer.getParams("#myForm"),$scope.work_scope=[$scope.workscope_one.key,$scope.workscope_two.key,$scope.workscope_three.key],console.info($scope.work_scope),$scope.work_scope&&($scope.user.work_scope=$scope.work_scope),console.info($scope.user),$http.post("http://"+$rootScope.hostName+"/center/lawyer/info",$scope.user).success(function(data){if(data&&data.data){data.data;layer.show("提交成功！"),location.href="#/index",window.location.reload()}})},$scope.submit=function(){$scope.user=layer.getParams("#myForm"),$scope.work_scope=[];var workscope_one=angular.element("#workscope_one").val(),workscope_two=angular.element("#workscope_two").val(),workscope_three=angular.element("#workscope_three").val();return""!=workscope_one&&$scope.work_scope.push(workscope_one),""!=workscope_two&&$scope.work_scope.push(workscope_two),""!=workscope_three&&$scope.work_scope.push(workscope_three),$scope.work_scope&&($scope.user.work_scope=$scope.work_scope),console.info($scope.work_scope),console.info($scope.user),$scope.user.license_file.length<1?(layer.show("请上传执业证书！"),!1):$scope.user.ID_img.length<1?(layer.show("请上传身份证照！"),!1):$scope.user.avatar.length<1?(layer.show("请上传个人头像图片！"),!1):$scope.user.bg_image.length<1?(layer.show("请上传背景图片！"),!1):void $http.post("http://"+$rootScope.hostName+"/center/become_lawyer",$scope.user).success(function(data){if(data&&data.data){var obj=data.data;currentUser=authService.getUser(),currentUser.user_group_id=obj.user.user_group_id,currentUser.is_verified=obj.user.is_verified,authService.setUser(currentUser),$scope.currentUser=currentUser,$scope.user={},$scope.file_1={},$scope.file_2={},$scope.file_3={},$scope.file_4={},$scope.progress_1={},$scope.progress_2={},$scope.progress_3={},$scope.progress_4={},sessionStorage.removeItem("workscopes_one"),sessionStorage.removeItem("workscopes_two"),sessionStorage.removeItem("get_work_scope"),layer.show("提交成功！"),location.href="#/index",window.location.reload()}})}}]),lvtuanApp.controller("followedlaywerCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/lawyer/customer/followed",$scope)}]),lvtuanApp.controller("commentlaywerCtrl",["$scope","$http","$rootScope","$stateParams","listHelper",function($scope,$http,$rootScope,$stateParams,listHelper){listHelper.bootstrap("/center/blog/reply",$scope)}]),lvtuanApp.controller("caselaywerCtrl",["$scope","listHelper","$stateParams",function($scope,listHelper,$stateParams){listHelper.bootstrap("/center/lawyer/blog/list?class="+$stateParams["class"],$scope)}]),lvtuanApp.controller("viewarticlelawyerCtrl",["$scope","$http","$rootScope","$stateParams","$ionicLoading","$timeout","$ionicPopup",function($scope,$http,$rootScope,$stateParams,$ionicLoading,$timeout,$ionicPopup){function init(){$ionicLoading.show(),$http.get("http://"+$rootScope.hostName+"/lawyer/article/"+$stateParams.id+"/view").success(function(data){return console.info(data.data),data.data?($timeout(function(){$ionicLoading.hide(),$scope.items=data.data}),!0):(layer.show("暂无数据！"),!1)})}init()}]),lvtuanApp.controller("aboutCtrl",["$scope","$timeout","$ionicPopup",function($scope,$timeout,$ionicPopup){$scope.showPopup=function(){$scope.data={};var myPopup=$ionicPopup.show({template:'<input type="password" ng-model="data.wifi">',title:"Enter Wi-Fi Password",subTitle:"Please use normal things",scope:$scope,buttons:[{text:"Cancel"},{text:"<b>Save</b>",type:"button-positive",onTap:function(e){return $scope.data.wifi?$scope.data.wifi:void e.preventDefault()}}]});myPopup.then(function(res){console.log("Tapped!",res)}),$timeout(function(){myPopup.close()},3e3)},$scope.showConfirm=function(){var confirmPopup=$ionicPopup.confirm({title:"温馨提示",template:"系统检测到有最新版本，点击确定进行下载。"});confirmPopup.then(function(res){res?console.log("You are sure"):console.log("You are not sure")})},$scope.showAlert=function(){var alertPopup=$ionicPopup.alert({title:"温馨提示",template:"您的软件已经是最新版本！"});alertPopup.then(function(res){console.log("Thank you for not eating my delicious ice cream cone")})}}]),lvtuanApp.controller("siteCtrl",["$scope","$http","$rootScope","authService",function($scope,$http,$rootScope,authService){console.info("设置"),$scope.logout=function(){authService.logout(),location.href="#/login",window.location.reload()}}]),lvtuanApp.controller("lawyerlistCtrl",["$scope","$state","$http","$rootScope","$location",function($scope,$state,$http,$rootScope,$location){function getCities(){$http.get("http://"+$rootScope.hostName+"/lawyer/cities").success(function(data){$scope.cities=data.data})}function getWorkscopes(){$http.get("http://"+$rootScope.hostName+"/lawyer/workscopes").success(function(data){$scope.workscopes=data.data})}function getPractisePeriods(){$http.get("http://"+$rootScope.hostName+"/lawyer/practiseperiods").success(function(data){console.info(data.data),$scope.periods=data.data})}function getParams(){var params=layer.getParams("#searchForm"),param=[];params.q&&param.push("q="+params.q),params.city_id&&param.push("city_id="+params.city_id),params.cat_id&&param.push("cat_id="+params.cat_id),params.experience&&param.push("experience="+params.experience),params.order_by&&param.push("order_by="+params.order_by),param=param.join("&"),console.info(param),geturl(param)}function geturl(param){var url;url=""!=param?"http://"+$rootScope.hostName+"/lawyer/list_lawyers?"+param+"&page="+page:"http://"+$rootScope.hostName+"/lawyer/list_lawyers?page="+page,console.info(url),$http.get(url).success(function(data){return console.info(data.data),data.data.length>0?($scope.moredata=!0,$scope.items=$scope.items.concat(data.data),void page++):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}$scope.orders=[{key:"",value:"离我最近"},{key:"most_popular",value:"人气最高"},{key:"best_evaluated",value:"评价最好"}],getCities(),getWorkscopes(),getPractisePeriods(),$scope.$watch("max",function(oldVal,newVal){newVal&&updateStars()});var page=1;$scope.moredata=!0,$scope.items=[],$scope.search=function(e){localStorage.removeItem("items"),localStorage.removeItem("q"),page=1,$scope.items=[],getParams(),layer.stopDefault(e)},$scope.searchCity=function(){page=1,$scope.items=[],getParams()},$scope.doRefresh=function(){page=1,$scope.items=[],getParams()},$scope.loadMore=function(){getParams()},$scope.jumppage=function(id){location.href="#/lawyer/"+id,window.location.reload()}}]),lvtuanApp.controller("viewCtrl",["$scope","$http","$rootScope","$stateParams","httpWrapper",function($scope,$http,$rootScope,$stateParams,httpWrapper){$scope.max=5,$scope.ratingVal=5,$scope.readonly=!0,$scope.onHover=function(val){$scope.hoverVal=val},$scope.onLeave=function(){$scope.hoverVal=null},$scope.tabs=[{title:"个人介绍",url:"selfintro.tpl.html"},{title:"评价",url:"evaluate.tpl.html"},{title:"文章",url:"article.tpl.html"}],$scope.currentTab="selfintro.tpl.html",$scope.onClickTab=function(tab){$scope.currentTab=tab.url},$scope.isActiveTab=function(tabUrl){return tabUrl==$scope.currentTab},httpWrapper.get("http://"+$rootScope.hostName+"/lawyer/"+$stateParams.id,function(data){$scope.items=data.data,$scope.ratingVal=$scope.items.average_evaluate_score,console.info($scope.items)}),$scope.graphic5=function(id,index){sessionStorage.setItem("lawyerId",id),sessionStorage.setItem("index",index),location.href="#/graphic"}}]),lvtuanApp.controller("viewevaluateCtrl",["$scope","$http","$rootScope","$stateParams","httpWrapper",function($scope,$http,$rootScope,$stateParams,httpWrapper){function getEvaluation(){var url="http://"+$rootScope.hostName+"/lawyer/"+$stateParams.id+"/articles?page="+page;$http.get(url).success(function(data){if(!(data.data.length>0))return layer.show("暂无数据！"),$scope.moredata=!1,!1;$scope.moredata=!0,$scope.evaluations=$scope.evaluations.concat(data.data),$scope.ratingVal=[];for(var i=0;i<$scope.evaluations.length;i++)$scope.ratingVal.push($scope.evaluations[i].evaluate_score);page++})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}$scope.max=5,$scope.readonly=!0,$scope.onHover=function(val){$scope.hoverVal=val},$scope.onLeave=function(){$scope.hoverVal=null},$scope.onChange=function(val){$scope.ratingVal=val},console.info("律师评价");var page=1;$scope.moredata=!0,$scope.evaluations=[],$scope.doRefresh=function(){page=1,$scope.evaluations=[],$scope.loadMore()},$scope.loadMore=function(){getEvaluation()},$scope.$on("$stateChangeSuccess",function(){$scope.loadMore()})}]),lvtuanApp.controller("viewarticleCtrl",["$scope","$http","$rootScope","$stateParams",function($scope,$http,$rootScope,$stateParams){function getArticles(){var url="http://"+$rootScope.hostName+"/lawyer/"+$stateParams.id+"/articles?page="+page;$http.get(url).success(function(data){return data.data.length>0?($scope.moredata=!0,$scope.articles=$scope.articles.concat(data.data),void page++):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}console.info("律师文章");var page=1;$scope.moredata=!0,$scope.articles=[],$scope.doRefresh=function(){page=1,$scope.articles=[],$scope.loadMore()},$scope.loadMore=function(){getArticles()},$scope.$on("$stateChangeSuccess",function(){$scope.loadMore()})}]),lvtuanApp.controller("viewteleviseCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/microblog/list/mine",$scope),$scope.likes=function(id,index){$http.post("http://"+$rootScope.hostName+"/like",{item_type:"post",item_id:id},{headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){console.info(data);var itmes=data.data;$scope.items[index].post_extra.likes_count=itmes.likes_count,layer.show("点赞成功！")})}}]),lvtuanApp.controller("graphicCtrl",["$scope","$http","$rootScope","$timeout","$stateParams","listHelper","httpWrapper","Upload",function($scope,$http,$rootScope,$timeout,$stateParams,listHelper,httpWrapper,Upload){$http.get("http://"+$rootScope.hostName+"/lawyer/workscopes").success(function(data){data.data?$scope.workscopes=data.data:layer.show("暂无数据！")}),$scope.file=[],$scope.uploadFiles=function(files,errFiles){return files&&files.length>2?(layer.show("最多只能上传2个文件或者图片！"),!1):($scope.files=files,$scope.errFiles=errFiles,angular.forEach(files,function(file){file.upload=Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/question/upfiles",data:{files:file}}),file.upload.then(function(response){var file_name="http://"+$rootScope.hostName+"/"+response.data.data.file_name;$scope.file.push(file_name),$scope.file=$scope.file,$timeout(function(){file.result=response.data})},function(response){response.status;response.status>0&&($scope.errorMsg=response.status+": "+response.data)},function(evt){file.progress=Math.min(100,parseInt(100*evt.loaded/evt.total)),$scope.progress=file.progress})}),void 0)},$scope.type=$stateParams.id;var lawyerId=sessionStorage.getItem("lawyerId"),index=sessionStorage.getItem("index");$scope.user={},$scope.submit=function(user){$scope.user=user,$scope.file.length>0&&($scope.user.file_paths=$scope.file),index&&($scope.user.type=index),lawyerId&&($scope.user.lawyer_id=lawyerId),httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/question/create","post",$scope.user,function(data){layer.show("提交成功！"),$scope.user={},$scope.files={},$scope.errFiles={}},function(data){console.info(data)})}}]),lvtuanApp.controller("specialCtrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){console.info("专业咨询")}]),lvtuanApp.controller("questionsCtrl",["$scope","$http","$rootScope","$timeout","$stateParams","listHelper","httpWrapper","Upload",function($scope,$http,$rootScope,$timeout,$stateParams,listHelper,httpWrapper,Upload){listHelper.bootstrap("/question/list_questions",$scope),$http.get("http://"+$rootScope.hostName+"/lawyer/workscopes").success(function(data){data.data?$scope.workscopes=data.data:layer.show("暂无数据！")}),localStorage.removeItem("q"),$scope.search=function(){var q=$.trim($(".search").val());localStorage.setItem("q",JSON.stringify(q)),$state.go("questionslist",{q:q},{reload:!0})},$scope.file=[],$scope.uploadFiles=function(files,errFiles){return files&&files.length>2?(layer.show("最多只能上传2个文件或者图片！"),!1):($scope.files=files,$scope.errFiles=errFiles,angular.forEach(files,function(file){file.upload=Upload.upload({headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token},url:"http://"+$rootScope.hostName+"/question/upfiles",data:{files:file}}),file.upload.then(function(response){var file_name="http://"+$rootScope.hostName+"/"+response.data.data.file_name;$scope.file.push(file_name),$scope.file=$scope.file,$timeout(function(){file.result=response.data})},function(response){response.status;response.status>0&&($scope.errorMsg=response.status+": "+response.data)},function(evt){file.progress=Math.min(100,parseInt(100*evt.loaded/evt.total)),$scope.progress=file.progress})}),void 0)},$scope.user={},$scope.submit=function(user){$scope.user=user,$scope.file.length>0&&($scope.user.file_paths=$scope.file),httpWrapper.request("http://"+$rootScope.hostName+"/question/create","post",$scope.user,function(data){layer.show("提交成功！"),$scope.user={},$scope.files={},$scope.errFiles={}},function(data){console.info(data.error_messages);var errMsg=JSON.stringify(data.error_messages.content[0]);layer.show(errMsg)})}}]),lvtuanApp.controller("questionslistCtrl",["$http","$scope","$state","$rootScope","$timeout",function($http,$scope,$state,$rootScope,$timeout){var q=JSON.parse(localStorage.getItem("q"));console.info(q),angular.element(".searchq").val(q);var page=1;$scope.moredata=!0,$scope.items=[],$scope.search=function(){localStorage.removeItem("q"),page=1,$scope.items=[],q=angular.element(".searchq").val(),$scope.loadMore()},$scope.doRefresh=function(){page=1,$scope.items=[],$scope.loadMore()},$scope.loadMore=function(){var url="";url=""==q||null==q?"http://"+$rootScope.hostName+"/question/list_questions?page="+page:"http://"+$rootScope.hostName+"/question/list_questions?q="+q+"&page="+page,$http.get(url).success(function(data){return data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,$scope.items=$scope.items.concat(data.data),void page++):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})},$scope.$on("$stateChangeSuccess",function(){$scope.loadMore()})}]),lvtuanApp.controller("questionsviewsCtrl",["$http","$scope","$state","$rootScope","$stateParams","$ionicLoading",function($http,$scope,$state,$rootScope,$stateParams,$ionicLoading){function init(){var url="http://"+$rootScope.hostName+"/question/"+$stateParams.id;$scope.show(),$http.get(url).success(function(data){console.info(data.data),$scope.items=data.data})["finally"](function(data){$scope.hide()})}$scope.show=function(){$ionicLoading.show({template:"Loading..."})},$scope.hide=function(){$ionicLoading.hide()},init()}]),lvtuanApp.controller("legaladviceCtrl",["$http","$scope","$rootScope",function($http,$scope,$rootScope){function getparamq(){var param=layer.getParams("#search_form");getUrlq(param)}function getUrlq(param){var url="";url+=param.q?"http://"+$rootScope.hostName+"/knowledge/article/list_articles?q="+param.q+"&page="+page++:"http://"+$rootScope.hostName+"/knowledge/article/list_articles?page="+page++,$http.get(url).success(function(data){return console.info("法规",data.data),data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,void($scope.knowledges=$scope.knowledges.concat(data.data))):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}var page=1;$scope.moredata=!0,$scope.knowledges=[],$scope.search=function(){page=1,$scope.knowledges=[],getparamq()},$scope.doRefresh=function(){page=1,$scope.knowledges=[],getparamq()},$scope.loadMore=function(){getparamq()}}]),lvtuanApp.controller("lawlectureCtrl",["$http","$scope","$state","$rootScope",function($http,$scope,$state,$rootScope){console.info("法律讲堂")}]),lvtuanApp.controller("casescommCtrl",["$http","$scope","$state","$rootScope",function($http,$scope,$state,$rootScope){console.info("案件委托")}]),lvtuanApp.controller("lvtuanallianceCtrl",["$http","$scope","$state","$rootScope",function($http,$scope,$state,$rootScope){function init(){var url="http://"+$rootScope.hostName+"/union/list_partners";$http.get(url).success(function(data){$scope.unions=data.data})}init()}]),lvtuanApp.controller("lvtuanallianceviewCtrl",["$http","$scope","$state","$rootScope","$stateParams",function($http,$scope,$state,$rootScope,$stateParams){function init(){var url="http://"+$rootScope.hostName+"/union/list_partners";$http.get(url).success(function(data){for(var itmes=data.data,i=0;i<itmes.length;i++)if(id==itmes[i].id){$scope.union=itmes[i];
break}})}var id=$stateParams.id;init()}]),lvtuanApp.controller("talentCtrl",["$http","$scope","$state","$rootScope",function($http,$scope,$state,$rootScope){function init(){var url="http://"+$rootScope.hostName+"/hr/list_positions";$http.get(url).success(function(data){$scope.positions=data.data,console.info($scope.positions)})}init()}]),lvtuanApp.controller("talentviewCtrl",["$http","$scope","$state","$rootScope","$stateParams",function($http,$scope,$state,$rootScope,$stateParams){function init(){var url="http://"+$rootScope.hostName+"/hr/"+$stateParams.id+"/view";$http.get(url).success(function(data){$scope.positions=data.data,console.info($scope.positions)})}init()}]),lvtuanApp.controller("workbenchLawyerCtrl",["$http","$scope","$state","$rootScope",function($http,$scope,$state,$rootScope){$http.get("http://"+$rootScope.hostName+"/center/lawyer/info").success(function(data){return data&&data.data?void($scope.items=data.data):(layer.show("暂无数据！"),!1)})}]),lvtuanApp.controller("orderAllCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/lawyer/question/all",$scope),$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/lawyer/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})},$scope.accept=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/accept","post",null,function(data){$scope.items.splice(index,1),layer.show("受理成功！")},function(data){console.info(data)})},$scope.refuse=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/refuse","post",null,function(data){$scope.items.splice(index,1),layer.show("拒绝成功！")},function(data){console.info(data)})},$scope.comment=function(id){location.href="#/lawyer/order/comment/"+id},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("orderNewCtrl",["$scope","$rootScope","listHelper","httpWrapper",function($scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/lawyer/question/new",$scope),$scope.accept=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/accept","post",null,function(data){$scope.items.splice(index,1),layer.show("受理成功！")},function(data){console.info(data)})},$scope.refuse=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/refuse","post",null,function(data){$scope.items.splice(index,1),layer.show("拒绝成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("orderRepliedCtrl",["$http","$rootScope","$scope","listHelper",function($http,$rootScope,$scope,listHelper){listHelper.bootstrap("/center/pay/lawyer/question/replied",$scope),$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("orderCompleteCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/lawyer/question/complete",$scope),$scope.comment=function(id){location.href="#/lawyer/order/comment/"+id},$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/lawyer/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("orderlawyerDetailCtrl",["$http","$scope","$stateParams","$rootScope","httpWrapper",function($http,$scope,$stateParams,$rootScope,httpWrapper){httpWrapper.get("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+$stateParams.id+"/view",function(data){$scope.item=data.data,console.info($scope.item)}),$scope.remove=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/lawyer/question/"+id+"/remove","post",null,function(data){layer.show("删除成功！")},function(data){console.info(data)})},$scope.accept=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/accept","post",null,function(data){layer.show("受理成功！")},function(data){console.info(data)})},$scope.refuse=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/pay/lawyer/question/"+id+"/refuse","post",null,function(data){layer.show("拒绝成功！")},function(data){console.info(data)})},$scope.comment=function(id){location.href="#/lawyer/order/comment/"+id},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("commentorderlawyerCtrl",["$http","$scope","$stateParams","$rootScope","$timeout","httpWrapper",function($http,$scope,$stateParams,$rootScope,$timeout,httpWrapper){$scope.max=5,$scope.ratingVal=5,$scope.readonly=!0,$scope.onHover=function(val){$scope.hoverVal=val},$scope.onLeave=function(){$scope.hoverVal=null},httpWrapper.get("http://"+$rootScope.hostName+"/center/lawyer/question/"+$stateParams.id+"/evaluate/view",function(data){$scope.item=data.data,console.info($scope.item),$scope.ratingVal=$scope.item.evaluate_score})}]),lvtuanApp.controller("lawyerquestionNewCtrl",["$scope","$rootScope","listHelper","httpWrapper",function($scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/lawyer/question/new",$scope),$scope.to_take=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/question/"+id+"/to_take","post",null,function(data){layer.show("抢单成功！"),location.href="#/lawyerquestion/replied",window.location.reload()},function(data){console.info(data)})}}]),lvtuanApp.controller("lawyerquestionRepliedCtrl",["$scope","$rootScope","$http","listHelper","httpWrapper",function($scope,$rootScope,$http,listHelper,httpWrapper){listHelper.bootstrap("/center/lawyer/question/replied",$scope),$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("lawyerquestionCompleteCtrl",["$scope","$rootScope","listHelper","httpWrapper",function($scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/lawyer/question/complete",$scope),$scope.comment=function(id){location.href="#/lawyer/order/comment/"+id},$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/lawyer/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("lawyerquestionsviewCtrl",["$http","$scope","$stateParams","$rootScope","httpWrapper",function($http,$scope,$stateParams,$rootScope,httpWrapper){httpWrapper.get("http://"+$rootScope.hostName+"/center/lawyer/question/"+$stateParams.id+"/view",function(data){$scope.items=data.data,console.info($scope.items)}),$scope.to_take=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/question/"+id+"/to_take","post",null,function(data){layer.show("抢单成功！"),location.href="#/lawyerquestion/replied",window.location.reload()},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})},$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/lawyer/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("easemobmainCtrl",["$scope","$http","$state","$rootScope","$stateParams",function($scope,$http,$state,$rootScope,$stateParams){function getuserpwd(itmes){var name=$("#user_name").val(),pwd=$("#user_password").val();return null==name||null==pwd?!1:name==itmes.easemob_id&&pwd==itmes.easemob_pwd?!0:void 0}localStorage.removeItem("easemoParam"),$scope.user_name="",$scope.user_password="",$("#user_name").val(""),$("#user_password").val(""),$http.get("http://"+$rootScope.hostName+"/center/question/"+$stateParams.id+"/ask").success(function(data){if(data&&data.data){console.info("圈子详情",data.data);var itmes=data.data;$scope.user_name=itmes.easemob_id,$scope.user_password=itmes.easemob_pwd,$scope.easemoParam={jumpUrl:"http://"+$rootScope.hostName+"/question/"+itmes.post_id+"/comment",rootUrl:"http://"+$rootScope.hostName+"/question/"+itmes.post_id+"/comment_list",curChatUserId:itmes.user_id,content:itmes.content,created_at:itmes.created_at.date,post_id:itmes.post_id,realname:itmes.realname,user_avatar:itmes.user_avatar,myName:itmes.myName,comments:itmes.comments},console.info($scope.easemoParam),$scope.jwtToken=localStorage.getItem("jwtToken"),console.info($scope.jwtToken),localStorage.setItem("easemoParam",JSON.stringify($scope.easemoParam));var time=null;time=setInterval(function(){1==getuserpwd(itmes)&&angular.isDefined(login)&&(login(),clearInterval(time))},2e3)}}),$scope.jumpreplied=function(){location.href="#/lawyerquestion/replied",window.location.reload()}}]),lvtuanApp.controller("userlvtuanCtrl",["$scope","$rootScope",function($scope,$rootScope){console.info("律师的律团")}]),lvtuanApp.controller("questionAllCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/question/all",$scope),$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})},$scope.cancel=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){$scope.items[index]=data.data.data,layer.show("取消成功！")},function(data){console.info(data)})},$scope.complete=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/to_complete","post",null,function(data){layer.show("确认成功！"),$scope.items.splice(index,1)},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})},$scope.send=function(id){location.href="#/send/mind/"+id},$scope.evaluate=function(id,index){$scope.items.splice(index,1),location.href="#/confirmCompletion/"+id}}]),lvtuanApp.controller("questionNewCtrl",["$scope","$rootScope","$http","listHelper","httpWrapper",function($scope,$rootScope,$http,listHelper,httpWrapper){listHelper.bootstrap("/center/question/new",$scope),$scope.cancel=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){$scope.items.splice(index,1),layer.show("取消成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("questionRepliedCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/question/replied",$scope),$scope.complete=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/to_complete","post",null,function(data){layer.show("确认成功！"),$scope.items.splice(index,1),location.href="#/userquestion/waitforconfirmation",window.location.reload()},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("questionWaitforconfirmationCtrl",["$scope","$rootScope","listHelper","httpWrapper",function($scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/question/waitforevaluation",$scope),$scope.evaluate=function(id,index){$scope.items.splice(index,1),location.href="#/confirmCompletion/"+id}}]),lvtuanApp.controller("confirmCompletionCtrl",["$scope","$http","$rootScope","$stateParams","listHelper","httpWrapper",function($scope,$http,$rootScope,$stateParams,listHelper,httpWrapper){listHelper.bootstrap("/center/question/waitforevaluation",$scope),$scope.max=5,$scope.ratingVal=5,$scope.readonly=!1,$scope.onHover=function(val){$scope.hoverVal=val},$scope.onLeave=function(){$scope.hoverVal=null},$scope.onChange=function(val){$scope.ratingVal=val,console.info(val)},$scope.user={evaluate_comment:""},$scope.submit=function(){var data={};$scope.ratingVal&&(data.evaluate_score=$scope.ratingVal),$scope.user.evaluate_comment&&(data.evaluate_comment=$scope.user.evaluate_comment),data=data,httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+$stateParams.id+"/to_evaluate","post",data,function(data){layer.show("评价成功！"),$scope.user={},location.href="#/userquestion/waitforconfirmation"},function(data){console.info(data)})},$scope.cancel=function(){$scope.ratingVal=5,$scope.user={evaluate_comment:""},window.location.reload()}}]),lvtuanApp.controller("userquestionviewCtrl",["$http","$scope","$stateParams","$rootScope","httpWrapper",function($http,$scope,$stateParams,$rootScope,httpWrapper){httpWrapper.get("http://"+$rootScope.hostName+"/center/question/"+$stateParams.id+"/view",function(data){$scope.items=data.data}),$scope.remove=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})},$scope.cancel=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){$scope.items[index]=data.data.data,layer.show("取消成功！")},function(data){console.info(data)})},$scope.to_complete=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/to_complete","post",null,function(data){layer.show("确认成功！"),location.href="#/userquestion/waitforconfirmation",window.location.reload()},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})},$scope.send=function(id){location.href="#/send/mind/"+id},$scope.evaluate=function(id,index){$scope.items.splice(index,1),location.href="#/confirmCompletion/"+id}}]),lvtuanApp.controller("sendmindCtrl",["$http","$scope","$rootScope","$stateParams",function($http,$scope,$rootScope,$stateParams){$scope.submit=function(){var money=$scope.user.money;return 0>=money?(layer.show("金额不能小于0！"),!1):money>1e6?(layer.show("金额不能大于1000000！"),!1):void $http.post("http://"+$rootScope.hostName+"/wallet/reward",{user_id:$stateParams.id,money:money}).success(function(data){layer.show("送心意成功。"),$scope.user={}})}}]),lvtuanApp.controller("userorderAllCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/question/all",$scope),$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})},$scope.cancel=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){$scope.items[index]=data.data.data,layer.show("取消成功！")},function(data){console.info(data)})},$scope.complete=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/to_complete","post",null,function(data){layer.show("确认成功！"),$scope.items.splice(index,1)},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})},$scope.pay=function(id){location.href="#/pay/"+id},$scope.evaluate=function(id,index){$scope.items.splice(index,1),location.href="#/confirmCompletion/"+id}}]),lvtuanApp.controller("userorderPendingCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/question/waitpay",$scope),$scope.remove=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/remove","post",null,function(data){$scope.items.splice(index,1),layer.show("删除成功！")},function(data){console.info(data)})},$scope.pay=function(id){location.href="#/pay/"+id}}]),lvtuanApp.controller("userorderNewCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/pay/question/new",$scope),$scope.cancel=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){$scope.items[index]=data.data.data,layer.show("取消成功！")},function(data){console.info(data)})}}]),lvtuanApp.controller("userorderRepliedCtrl",["$http","$scope","$rootScope","listHelper","httpWrapper",function($http,$scope,$rootScope,listHelper,httpWrapper){listHelper.bootstrap("/center/pay/question/replied",$scope),$scope.complete=function(id,index){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/to_complete","post",null,function(data){layer.show("确认成功！"),$scope.items.splice(index,1)},function(data){console.info(data)})},$scope.ask=function(id){$http.get("http://"+$rootScope.hostName+"/center/question/"+id+"/ask").success(function(data){location.href="#/easemobmain/"+id,window.location.reload()})}}]),lvtuanApp.controller("userorderWaitforevaluationCtrl",["$scope","listHelper",function($scope,listHelper){listHelper.bootstrap("/center/pay/question/waitforevaluation",$scope),$scope.evaluate=function(id,index){$scope.items.splice(index,1),location.href="#/confirmCompletion/"+id}}]),lvtuanApp.controller("userOrderDetailCtrl",["$http","$scope","$state","$rootScope","$stateParams",function($http,$scope,$state,$rootScope,$stateParams){$http.get("http://"+$rootScope.hostName+"/center/pay/question/"+$stateParams.id+"/view").success(function(data){return data&&data.data?($scope.item=data.data,!0):(layer.show("暂无数据！"),!1)}),$scope.remove=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/remove","post",null,function(data){layer.show("删除成功！"),location.href="#/orderuser/pending",window.location.reload()},function(data){console.info(data)})},$scope.pay=function(id){location.href="#/pay/"+id},$scope.cancel=function(id){httpWrapper.request("http://"+$rootScope.hostName+"/center/question/"+id+"/cancel","post",null,function(data){layer.show("取消成功！"),location.href="#/orderuser/new",window.location.reload()},function(data){console.info(data)})}}]),lvtuanApp.controller("documentlistCtrl",["$http","$scope","$state","$rootScope","$timeout",function($http,$scope,$state,$rootScope,$timeout){function getParams(){var params=layer.getParams("#search_form");console.info(params);var param=[];params.q&&param.push("q="+params.q),params.cat_id&&param.push("cat_id="+params.cat_id),param=param.join("&"),console.info(param),geturl(param)}function geturl(param){var url="";url+=param?"http://"+$rootScope.hostName+"/knowledge/document/list_documents?"+param+"&page="+page++:"http://"+$rootScope.hostName+"/knowledge/document/list_documents?page="+page++,$http.get(url).success(function(data){return console.info("法律文书",data.data),data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,void($scope.items=$scope.items.concat(data.data))):(layer.show("暂无数据！"),$scope.moredata=!1,!1)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")})}$http.get("http://"+$rootScope.hostName+"/lawyer/workscopes").success(function(data){data.data?$scope.workscopes=data.data:layer.show("暂无数据！")});var page=1;$scope.moredata=!0,$scope.items=[],$scope.search=function(){page=1,$scope.items=[],getParams()},$scope.searchCatId=function(){page=1,$scope.items=[],getParams()},$scope.doRefresh=function(){page=1,$scope.items=[],getParams()},$scope.loadMore=function(){getParams()}}]),lvtuanApp.controller("documentownloadlistCtrl",["$http","$scope","$state","$rootScope","$stateParams",function($http,$scope,$state,$rootScope,$stateParams){$http.get("http://"+$rootScope.hostName+"/knowledge/document/"+$stateParams.id+"/view").success(function(data){console.info("法律文书详情",data.data),$scope.itmes=data.data})}]),lvtuanApp.controller("corporateservicesCtrl",["$http","$scope","$state","$rootScope","$stateParams",function($http,$scope,$state,$rootScope,$stateParams){var page=1;$scope.moredata=!0,$scope.items=[],$scope.doRefresh=function(){page=1,$scope.items=[],$scope.loadMore()},$scope.loadMore=function(){$http.get("http://"+$rootScope.hostName+"/company/product/list?page="+page++).success(function(data){return console.info("待确认",data.data),data.data.length>0?(data.data.length>9?$scope.moredata=!0:$scope.moredata=!1,$scope.items=data.data,!0):($scope.moredata=!1,layer.show("暂无数据！"),!1)})}}]),lvtuanApp.controller("corporatelistCtrl",["$scope","$state","$http","$rootScope","$stateParams","$ionicPopup","$timeout",function($scope,$state,$http,$rootScope,$stateParams,$ionicPopup,$timeout){$scope.tabs=[{title:"产品详情",url:"list-detail.tpl.html"},{title:"评价",url:"list-evaluate.tpl.html"}],$scope.currentTab="list-detail.tpl.html",$scope.onClickTab=function(tab){$scope.currentTab=tab.url},$scope.isActiveTab=function(tabUrl){return tabUrl==$scope.currentTab},$http.get("http://"+$rootScope.hostName+"/company/product/"+$stateParams.id+"/view").success(function(data){console.info("详情",data.data),$scope.items=data.data})}]),lvtuanApp.controller("corporatelistevaluateCtrl",["$scope","$http","$rootScope","$stateParams",function($scope,$http,$rootScope,$stateParams){console.info("id",$stateParams.id),$http.get("http://"+$rootScope.hostName+"/company/product/"+$stateParams.id+"/comments").success(function(data){console.info("评价详情",data.data),$scope.items=data.data,$scope.ratingVal=[];for(var i=0;i<$scope.items.length;i++)$scope.ratingVal.push($scope.items[i].score)}),$scope.max=5,$scope.readonly=!0,$scope.onHover=function(val){$scope.hoverVal=val},$scope.onLeave=function(){$scope.hoverVal=null},$scope.onChange=function(val){$scope.ratingVal=val}}]),lvtuanApp.controller("corporatebuynowCtrl",["$scope","$http","$rootScope","$stateParams",function($scope,$http,$rootScope,$stateParams){function getProvince(){$http.get("http://"+$rootScope.hostName+"/area/province").success(function(data){console.info(data.data),$scope.provinces=data.data})}$http.get("http://"+$rootScope.hostName+"/company/product/"+$stateParams.id+"/view").success(function(data){console.info("详情",data.data),$scope.items=data.data}),getProvince(),$scope.getCity=function(province){$http.get("http://"+$rootScope.hostName+"/area/"+province+"/city").success(function(data){$scope.citys=data.data})},$scope.getDistrict=function(city){$http.get("http://"+$rootScope.hostName+"/area/"+city+"/district").success(function(data){$scope.districts=data.data})},$scope.submit=function(user){$scope.items={},user.contact_phone&&($scope.items.contact_phone=user.contact_phone),user.email&&($scope.items.email=user.email),user.company_name&&($scope.items.company_name=user.company_name),user.contact&&($scope.items.contact=user.contact),user.memo&&($scope.items.memo=user.memo),user.province.key&&($scope.items.province=user.province.key),user.city.key&&($scope.items.city=user.city.key),user.district.key&&($scope.items.district=user.district.key),1==user.invoice?$scope.items.invoice="Y":$scope.items.invoice="N",$stateParams.id&&($scope.items.product_id=$stateParams.id),console.info($scope.items),$http.post("http://"+$rootScope.hostName+"/company/order/submit",$scope.items).success(function(data){console.log(data.data),layer.show("提交成功！"),$scope.user={},$scope.items={},location.href="#/corporate"})}}]),lvtuanApp.controller("userwalletCtrl",["$scope","$http","$rootScope","authService",function($scope,$http,$rootScope,authService){var currentUser=authService.getUser();1==currentUser.user_group_id||2==currentUser.user_group_id&&0==currentUser.is_verified?$http.get("http://"+$rootScope.hostName+"/center/customer/wallet").success(function(data){data&&data.data&&($scope.items=data.data,sessionStorage.setItem("summoney",$scope.items.money))}):$http.get("http://"+$rootScope.hostName+"/center/lawyer/wallet").success(function(data){data&&data.data&&($scope.items=data.data,localStorage.setItem("money",$scope.items.money))})}]),lvtuanApp.controller("usermoneyinCtrl",["$scope","$http","$rootScope","$stateParams","authService",function($scope,$http,$rootScope,$stateParams,authService){var self=this;$scope.summoney=sessionStorage.getItem("summoney");var currentUser=authService.getUser();self.jsApiCall=function(){currentUser.wx_openid?$http.get("http://"+$rootScope.hostName+"/payment/jsapiparams/"+currentUser.wx_openid,{}).success(function(data){console.info(data),data&&data.data&&data.data.params&&(self.params=data.data.params,WeixinJSBridge.invoke("getBrandWCPayRequest",self.params,function(res){WeixinJSBridge.log(res.err_msg),alert(res.err_code+res.err_desc+res.err_msg)}))}):layer.show("用户需要先通过微信登录才可以使用这个功能")},self.callpay=function(){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",self.jsApiCall(),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",self.jsApiCall()),document.attachEvent("onWeixinJSBridgeReady",self.jsApiCall())):self.jsApiCall()},$scope.submit=function(user){self.callpay()}}]),lvtuanApp.controller("userrecordCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/wallet/record?type=recharge",$scope)}]),lvtuanApp.controller("usermoneyoutCtrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){$scope.summoney=sessionStorage.getItem("summoney"),$scope.submit=function(user){$http.post("http://"+$rootScope.hostName+"/wallet/withdraw",user).success(function(data){$scope.items=data.data,console.info($scope.items),sessionStorage.setItem("summoney",$scope.items.money),$scope.summoney=$scope.items.money,layer.show("提交成功！"),$scope.user={},console.info($scope.user)})}}]),lvtuanApp.controller("userwithdrawCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){listHelper.bootstrap("/wallet/record?type=withdraw",$scope)}]),lvtuanApp.controller("userpayallCtrl",["$scope","$http","$rootScope","listHelper",function($scope,$http,$rootScope,listHelper){$scope.rows_per_page=15,listHelper.bootstrap("/wallet/record",$scope)}]),lvtuanApp.controller("payCtrl",["$scope","$http","$rootScope","$stateParams","$ionicPopup","listHelper",function($scope,$http,$rootScope,$stateParams,$ionicPopup,listHelper){$http.get("http://"+$rootScope.hostName+"/center/pay/question/"+$stateParams.id+"/view").success(function(data){return data&&data.data?($scope.item=data.data,console.info($scope.item),!0):(layer.show("暂无数据！"),!1)}),$scope.obj="",$scope.change=function(val){$scope.obj=val},$scope.pay=function(){if(console.info($scope.obj),"weixin"==$scope.obj)layer.show("研发中...敬请期待。");else{var confirmPopup=$ionicPopup.confirm({title:"是否立即付款？",cancelText:"取消",okText:"确认"});confirmPopup.then(function(res){return res?void $http.post("http://"+$rootScope.hostName+"/center/question/"+$stateParams.id+"/wallet/pay",{},{headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(function(data){$scope.items=data.data,layer.show("付款成功！"),location.href="#/orderuser/new",window.location.reload()}):!1})}}}]),lvtuanApp.controller("citypickerCtrl",["$state","$timeout","$http","$location","$scope","$rootScope","$anchorScroll","$stateParams","$ionicHistory",function($state,$timeout,$http,$location,$scope,$rootScope,$anchorScroll,$stateParams,$ionicHistory){console.info("citypickerCtrl"),$scope.provinces={A:{"安徽":["合肥市","芜湖市","蚌埠市","淮南市","马鞍山市","淮北市","铜陵市","安庆市","黄山市","滁州市","阜阳市","宿州市","巢湖市","六安市","亳州市","池州市","宣城市"]},B:{"北京":["北京市"]},C:{"重庆":["重庆市"]},F:{"福建":["福州市","厦门市","莆田市","三明市","泉州市","漳州市","南平市","龙岩市","宁德市"]},G:{"甘肃":["兰州市","嘉峪关市","金昌市","白银市","天水市","武威市","张掖市","平凉市","酒泉市","庆阳市","定西市","陇南市","临夏回族自治州","甘南藏族自治州"],"广东":["广州市","深圳市","珠海市","汕头市","韶关市","佛山市","江门市","湛江市","茂名市","肇庆市","惠州市","梅州市","汕尾市","河源市","阳江市","清远市","东莞市","中山市","潮州市","揭阳市","云浮市"],"广西":["南宁市","柳州市","桂林市","梧州市","北海市","防城港市","钦州市","贵港市","玉林市","百色市","贺州市","河池市","来宾市","崇左市"],"贵州":["贵阳市","六盘水市","遵义市","安顺市","铜仁地区","黔西南布依族苗族自治州","毕节地区","黔东南苗族侗族自治州","黔南布依族苗族自治州"]},H:{"海南":["海口市","三亚市"],"河北":["石家庄市","唐山市","秦皇岛市","邯郸市","邢台市","保定市","张家口市","承德市","沧州市","廊坊市","衡水市"],"河南":["郑州市","开封市","洛阳市","平顶山市","安阳市","鹤壁市","新乡市","焦作市","濮阳市","许昌市","漯河市","三门峡市","南阳市","商丘市","信阳市","周口市","驻马店市"],"黑龙江":["哈尔滨市","齐齐哈尔市","鸡西市","鹤岗市","双鸭山市","大庆市","伊春市","佳木斯市","七台河市","牡丹江市","黑河市","绥化市","大兴安岭地区"],"湖北":["武汉市","黄石市","十堰市","宜昌市","襄樊市","鄂州市","荆门市","孝感市","荆州市","黄冈市","咸宁市","随州市","恩施土家族苗族自治州","神农架"],"湖南":["长沙市","株洲市","湘潭市","衡阳市","邵阳市","岳阳市","常德市","张家界市","益阳市","郴州市","永州市","怀化市","娄底市","湘西土家族苗族自治州"]},J:{"吉林":["长春市","吉林市","四平市","辽源市","通化市","白山市","松原市","白城市","延边朝鲜族自治州"],"江苏":["南京市","无锡市","徐州市","常州市","苏州市","南通市","连云港市","淮安市","盐城市","扬州市","镇江市","泰州市","宿迁市"],"江西":["南昌市","景德镇市","萍乡市","九江市","新余市","鹰潭市","赣州市","吉安市","宜春市","抚州市","上饶市"]},L:{"辽宁":["沈阳市","大连市","鞍山市","抚顺市","本溪市","丹东市","锦州市","营口市","阜新市","辽阳市","盘锦市","铁岭市","朝阳市","葫芦岛市"]},N:{"内蒙古":["呼和浩特市","包头市","乌海市","赤峰市","通辽市","鄂尔多斯市","呼伦贝尔市","巴彦淖尔市","乌兰察布市","兴安盟","锡林郭勒盟","阿拉善盟"],"宁夏":["银川市","石嘴山市","吴忠市","固原市","中卫市"]},Q:{"青海":["西宁市","海东地区","海北藏族自治州","黄南藏族自治州","海南藏族自治州","果洛藏族自治州","玉树藏族自治州","海西蒙古族藏族自治州"]},S:{"山东":["济南市","青岛市","淄博市","枣庄市","东营市","烟台市","潍坊市","济宁市","泰安市","威海市","日照市","莱芜市","临沂市","德州市","聊城市","滨州市","菏泽市"],"山西":["太原市","大同市","阳泉市","长治市","晋城市","朔州市","晋中市","运城市","忻州市","临汾市","吕梁市"],"陕西":["西安市","铜川市","宝鸡市","咸阳市","渭南市","延安市","汉中市","榆林市","安康市","商洛市"],"上海":["上海市"],"四川":["成都市","自贡市","攀枝花市","泸州市","德阳市","绵阳市","广元市","遂宁市","内江市","乐山市","南充市","眉山市","宜宾市","广安市","达州市","雅安市","巴中市","资阳市","阿坝藏族羌族自治州","甘孜藏族自治州","凉山彝族自治州"]},T:{"天津":["天津市"]},X:{"西藏":["拉萨市","昌都地区","山南地区","日喀则地区","那曲地区","阿里地区","林芝地区"],"新疆":["乌鲁木齐市","克拉玛依市","吐鲁番地区","哈密地区","昌吉回族自治州","博尔塔拉蒙古自治州","巴音郭楞蒙古自治州","阿克苏地区","克孜勒苏柯尔克孜自治州","喀什地区","和田地区","伊犁哈萨克自治州","塔城地区","阿勒泰地区","石河子市","阿拉尔市","图木舒克市","五家渠市"]},Y:{"云南":["昆明市","曲靖市","玉溪市","保山市","昭通市","丽江市","思茅市","临沧市","楚雄彝族自治州","红河哈尼族彝族自治州","文山壮族苗族自治州","西双版纳傣族自治州","大理白族自治州","德宏傣族景颇族自治州","怒江傈僳族自治州","迪庆藏族自治州"]},Z:{"浙江":["杭州市","宁波市","温州市","嘉兴市","湖州市","绍兴市","金华市","衢州市","舟山市","台州市","丽水市"]}},$scope.str=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],$scope["goto"]=function(id){$location.hash(id),$anchorScroll()},$scope.province=function(key,val){$(".citypicker .province").hide(),console.info(key,val),$scope.province_key=key,$scope.cities=val,$(".citypicker .cities").show(),console.info($scope.cities)},$scope.citie=function(val){$(".citypicker .province,.citypicker .cities").hide(),console.info($scope.province_key,val),$scope.items={city_id:$scope.province_key,region_id:val},sessionStorage.setItem("citypicker",JSON.stringify($scope.items)),$scope.citypicker=JSON.parse(sessionStorage.getItem("citypicker")),$rootScope.region_id=$scope.citypicker.region_id,$ionicHistory.goBack()}}]),angular.module("lvtuanApp",["ionic","lvtuanApp.Ctrl","templates"]).run(["$ionicPlatform",function($ionicPlatform){$ionicPlatform.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}]).run(["$rootScope","$timeout","$location","$ionicLoading",function($rootScope,$timeout,$location,$ionicLoading,$ionicHistory,$window){
$rootScope.show=function(){$ionicLoading.show({template:'<ion-spinner icon="circles"></ion-spinner>',noBackdrop:!1})},$rootScope.hide=function(){$ionicLoading.hide()};var hostName=AppSettings.baseApiUrl;localStorage.setItem("hostName",JSON.stringify(hostName)),$rootScope.hostName=JSON.parse(localStorage.getItem("hostName")),$rootScope.region_id_user=JSON.parse(localStorage.getItem("currentUser")),$rootScope.region_id_user&&($rootScope.region_id=$rootScope.region_id_user.region_id),$rootScope.goHome=function(){layer.goHome()}}]).run(function($rootScope,$location,$state,authService){$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){toState.authn&&(authService.isAuthed()?(currentUser=authService.getUser(),toState.authz&&"lawyer"==toState.authz&&!currentUser.is_verified_lawyer&&($rootScope.$broadcast("unauthorized"),$state.transitionTo("login"),event.preventDefault())):($rootScope.$broadcast("unauthenticated"),event.preventDefault()))}),$rootScope.$on("unauthorized",function(){layer.show("您没有权限访问这个链接！"),$location.path("/login"),$state.transitionTo("login")}),$rootScope.$on("unauthenticated",function(){layer.show("请先登录！"),$state.transitionTo("login")})}).config(function($httpProvider){$httpProvider.interceptors.push("APIInterceptor")}).config(function($stateProvider,$urlRouterProvider){$stateProvider.state("home",{url:"/home",cache:"true",templateUrl:"template/home.html",controller:"ionicNavBarDelegateCtrl"}).state("index",{url:"/index",templateUrl:"template/index_tpl.html",controller:"indexCtrl"}).state("mylvteam",{url:"/mylvteam",cache:"true",templateUrl:"template/mylvteam.html"}).state("login",{url:"/login",cache:"true",templateUrl:"template/home/login.html"}).state("register",{url:"/register",cache:"true",templateUrl:"template/home/register.html"}).state("resetpwd",{url:"/resetpwd",cache:"true",templateUrl:"template/home/resetpwd.html"}).state("wxauth",{url:"/wxauth?code&state",cache:"true",controller:"wxAuthCtrl"}).state("wxlogin",{url:"/wxlogin",cache:"true",controller:"wxLoginCtrl"}).state("group",{url:"/group",cache:"true",templateUrl:"template/group/group.html",controller:"groupCtrl",authn:!0,authz:"lawyer"}).state("group.list",{url:"/list",cache:"true",views:{"group-list":{templateUrl:"template/group/group-list.html",controller:"groupListCtrl"}},authn:!0,authz:"lawyer"}).state("group.televise",{url:"/televise",cache:"true",views:{"group-televise":{templateUrl:"template/group/group-televise.html",controller:"groupTeleviseCtrl"}},authn:!0,authz:"lawyer"}).state("group.attention",{url:"/attention",cache:"true",views:{"group-attention":{templateUrl:"template/group/group-attention.html",controller:"groupAttentionCtrl"}},authn:!0,authz:"lawyer"}).state("groupview",{url:"/group/view/:id",templateUrl:"template/group/group_view.html",controller:"groupviewCtrl",authn:!0,authz:"lawyer"}).state("broadcast/view",{url:"/broadcast/view/:id",templateUrl:"template/group/broadcast_view.html",controller:"broadcastviewCtrl",authn:!0,authz:"lawyer"}).state("groupcreate",{url:"/groupcreate",templateUrl:"template/group/create.html",controller:"groupcreateCtrl",authn:!0,authz:"lawyer"}).state("televisecreate",{url:"/televisecreate",templateUrl:"template/group/televisecreate.html",controller:"televisecreateCtrl",authn:!0,authz:"lawyer"}).state("group/site",{url:"/group/site/:id",templateUrl:"template/group/group-site.html",controller:"groupsiteCtrl",authn:!0,authz:"lawyer"}).state("group/add",{url:"/group/add/:id",templateUrl:"template/group/group-add.html",controller:"groupaddCtrl",authn:!0,authz:"lawyer"}).state("knowledge",{url:"/knowledge",templateUrl:"template/knowledge/knowledge.html"}).state("knowledge.knowledges",{url:"/knowledges",cache:"true",views:{"knowledge-knowledges":{templateUrl:"template/knowledge/knowledge-knowledges.html",controller:"knowledgesCtrl"}}}).state("knowledge.documents",{url:"/documents",cache:"true",views:{"knowledge-documents":{templateUrl:"template/knowledge/knowledge-documents.html",controller:"documentsCtrl"}}}).state("knowledge.cases",{url:"/cases",cache:"true",views:{"knowledge-cases":{templateUrl:"template/knowledge/knowledge-cases.html",controller:"casesCtrl"}}}).state("knowledgeview",{url:"/knowledgeview/:id",cache:"true",templateUrl:"template/knowledge/knowledges-view.html",controller:"knowledgeViewCtrl"}).state("comments/view",{url:"/comments/view/:id",cache:"true",templateUrl:"template/knowledge/comments-view.html",controller:"commentsViewCtrl"}).state("center",{url:"/center",cache:"true",templateUrl:"template/center/center.html",controller:"centerCtrl",authn:!0}).state("info",{url:"/info",cache:"true",templateUrl:"template/center/info.html",controller:"infoCtrl",authn:!0}).state("comment",{url:"/comment",cache:"true",templateUrl:"template/center/comment.html",controller:"commentCtrl",authn:!0}).state("followed",{url:"/followed",cache:"true",templateUrl:"template/center/followed.html",controller:"followedCtrl",authn:!0}).state("becomelawyer",{url:"/becomelawyer",cache:"true",templateUrl:"template/center/become_lawyer.html",controller:"becomelawyerCtrl",authn:!0}).state("followed_lawyer",{url:"/followed_lawyer",cache:"true",templateUrl:"template/center/lawyer/followed.html",controller:"followedlaywerCtrl",authn:!0}).state("comment_lawyer",{url:"/comment_lawyer/:id",cache:"false",templateUrl:"template/center/lawyer/comment.html",controller:"commentlaywerCtrl",authn:!0}).state("article_lawyer",{url:"/article_lawyer",templateUrl:"template/center/lawyer/article.html",authn:!0}).state("article_lawyer.case",{url:"/case/:class",views:{"article-case":{templateUrl:"template/center/lawyer/article-case.html",controller:"caselaywerCtrl"}},authn:!0}).state("article_lawyer.advisory",{url:"/advisory/:class",views:{"article-advisory":{templateUrl:"template/center/lawyer/article-advisory.html",controller:"caselaywerCtrl"}},authn:!0}).state("article_lawyer.lknowledge",{url:"/lknowledge/:class",views:{"article-lknowledge":{templateUrl:"template/center/lawyer/article-lknowledge.html",controller:"caselaywerCtrl"}},authn:!0}).state("/lawyer/article/view",{url:"/lawyer/article/view/:id",templateUrl:"template/center/lawyer/view.html",controller:"viewarticlelawyerCtrl",authn:!0}).state("about",{url:"/about",cache:"true",templateUrl:"template/center/about.html",controller:"aboutCtrl",authn:!0}).state("site",{url:"/site",cache:"true",templateUrl:"template/center/site.html",controller:"siteCtrl",authn:!0}).state("listscores",{url:"/listscores",cache:"true",templateUrl:"template/center/list_scores.html",controller:"listscoresCtrl",authn:!0}).state("collect",{url:"/collect",cache:"true",templateUrl:"template/center/collect.html",controller:"collectCtrl",authn:!0}).state("messages",{url:"/messages",cache:"true",templateUrl:"template/center/messages.html",controller:"messagesCtrl",authn:!0}).state("message_details",{url:"/message/:id",cache:"true",templateUrl:"template/center/message_view.html",controller:"viewMessageCtrl",authn:!0}).state("lawyerlist",{url:"/lawyerlist",cache:"true",templateUrl:"template/lawyer/lawyer_list.html",controller:"lawyerlistCtrl"}).state("lawyer",{url:"/lawyer/:id",cache:"true",templateUrl:"template/lawyer/view.html",controller:"viewCtrl"}).state("graphic",{url:"/graphic",cache:"true",templateUrl:"template/lawyer/graphic.html"}).state("special",{url:"/special",cache:"true",templateUrl:"template/lawyer/special.html",controller:"specialCtrl"}).state("questions",{url:"/questions",cache:"true",templateUrl:"template/questions/questions.html",controller:"questionsCtrl"}).state("questionslist",{cache:"true",url:"/questionslist",templateUrl:"template/questions/questions_list.html",controller:"questionslistCtrl"}).state("questionsview",{cache:"true",url:"/questionsview/:id",templateUrl:"template/questions/view.html",controller:"questionsviewsCtrl"}).state("legaladvice",{url:"/legaladvice",templateUrl:"template/legaladvice.html",controller:"legaladviceCtrl"}).state("workbenchlawyer",{url:"/workbenchlawyer",templateUrl:"template/mylvtuan/lawyer/workbench-lawyer.html",controller:"workbenchLawyerCtrl",authn:!0}).state("orderlawyer",{url:"/orderlawyer",templateUrl:"template/mylvtuan/lawyer/order/order-lawyer.html",authn:!0}).state("orderlawyer.all",{url:"/all",cache:"true",views:{"order-all":{templateUrl:"template/mylvtuan/lawyer/order/order-all.html",controller:"orderAllCtrl"}},authn:!0}).state("orderlawyer.new",{url:"/new",cache:"true",views:{"order-new":{templateUrl:"template/mylvtuan/lawyer/order/order-new.html",controller:"orderNewCtrl"}},authn:!0}).state("orderlawyer.replied",{url:"/replied",cache:"true",views:{"order-replied":{templateUrl:"template/mylvtuan/lawyer/order/order-replied.html",controller:"orderRepliedCtrl"}},authn:!0}).state("orderlawyer.complete",{url:"/complete",cache:"true",views:{"order-complete":{templateUrl:"template/mylvtuan/lawyer/order/order-complete.html",controller:"orderCompleteCtrl"}},authn:!0}).state("orderlawyerdetail",{url:"/orderlawyerdetail/:id",templateUrl:"template/mylvtuan/lawyer/order/order-detail.html",controller:"orderlawyerDetailCtrl",authn:!0}).state("/lawyer/order/comment",{url:"/lawyer/order/comment/:id",templateUrl:"template/mylvtuan/lawyer/order/comment.html",controller:"commentorderlawyerCtrl",authn:!0}).state("lawyerquestion",{url:"/lawyerquestion",templateUrl:"template/mylvtuan/lawyer/question/question.html",authn:!0}).state("lawyerquestion.new",{url:"/new",cache:"true",views:{"question-new":{templateUrl:"template/mylvtuan/lawyer/question/new.html",controller:"lawyerquestionNewCtrl"}},authn:!0}).state("lawyerquestion.replied",{url:"/replied",cache:"true",views:{"question-replied":{templateUrl:"template/mylvtuan/lawyer/question/replied.html",controller:"lawyerquestionRepliedCtrl"}},authn:!0}).state("lawyerquestion.complete",{url:"/complete",cache:"true",views:{"question-complete":{templateUrl:"template/mylvtuan/lawyer/question/complete.html",controller:"lawyerquestionCompleteCtrl"}},authn:!0}).state("lawyer/questions/view",{url:"/lawyer/questions/view/:id",cache:"true",templateUrl:"template/mylvtuan/lawyer/question/view.html",controller:"lawyerquestionsviewCtrl",authn:!0}).state("queryrefer",{url:"/queryrefer",cache:"true",templateUrl:"template/mylvtuan/lawyer/queryrefer.html",authn:!0}).state("queryreferdetail",{url:"/queryreferdetail",cache:"true",templateUrl:"template/mylvtuan/lawyer/queryrefer-detail.html",authn:!0}).state("easemobmain",{url:"/easemobmain/:id",templateUrl:"template/mylvtuan/easemobmain.html",controller:"easemobmainCtrl",authn:!0}).state("userlvtuan",{url:"/userlvtuan",cache:"true",templateUrl:"template/mylvtuan/user/userlvtuan.html",controller:"userlvtuanCtrl",authn:!0}).state("userquestion",{url:"/userquestion",templateUrl:"template/mylvtuan/user/question/question.html",authn:!0}).state("userquestion.new",{url:"/new",cache:"true",views:{"question-new":{templateUrl:"template/mylvtuan/user/question/new.html",controller:"questionNewCtrl"}},authn:!0}).state("userquestion.all",{url:"/all",cache:"true",views:{"question-all":{templateUrl:"template/mylvtuan/user/question/all.html",controller:"questionAllCtrl"}},authn:!0}).state("userquestion.replied",{url:"/replied",cache:"true",views:{"question-replied":{templateUrl:"template/mylvtuan/user/question/replied.html",controller:"questionRepliedCtrl"}},authn:!0}).state("userquestion.waitforconfirmation",{url:"/waitforconfirmation",cache:"true",views:{"question-waitforconfirmation":{templateUrl:"template/mylvtuan/user/question/waitforconfirmation.html",controller:"questionWaitforconfirmationCtrl"}},authn:!0}).state("user/question/view",{url:"/user/question/view/:id",templateUrl:"template/mylvtuan/user/question/view.html",controller:"userquestionviewCtrl",authn:!0}).state("confirmCompletion",{url:"/confirmCompletion/:id",templateUrl:"template/mylvtuan/user/question/confirm-completion.html",authn:!0}).state("orderuser",{url:"/orderuser",templateUrl:"template/mylvtuan/user/order/order-user.html",authn:!0}).state("orderuser.all",{url:"/all",cache:"true",views:{"order-all":{templateUrl:"template/mylvtuan/user/order/order-all.html",controller:"userorderAllCtrl"}},authn:!0}).state("orderuser.pending",{url:"/pending",cache:"true",views:{"order-pending":{templateUrl:"template/mylvtuan/user/order/order-pending.html",controller:"userorderPendingCtrl"}},authn:!0}).state("orderuser.new",{url:"/new",cache:"true",views:{"order-new":{templateUrl:"template/mylvtuan/user/order/order-new.html",controller:"userorderNewCtrl"}},authn:!0}).state("orderuser.replied",{url:"/replied",cache:"true",views:{"order-replied":{templateUrl:"template/mylvtuan/user/order/order-replied.html",controller:"userorderRepliedCtrl"}},authn:!0}).state("orderuser.waitforevaluation",{url:"/waitforevaluation",cache:"true",views:{"order-waitforevaluation":{templateUrl:"template/mylvtuan/user/order/order-waitforevaluation.html",controller:"userorderWaitforevaluationCtrl"}},authn:!0}).state("orderuser.complete",{url:"/complete",cache:"true",views:{"order-complete":{templateUrl:"template/mylvtuan/user/order/order-complete.html",controller:"userorderCompleteCtrl"}},authn:!0}).state("send/mind",{url:"/send/mind/:id",templateUrl:"template/mylvtuan/user/question/send-mind.html",authn:!0}).state("userorderdetail",{url:"/userorderdetail/:id",templateUrl:"template/mylvtuan/user/order/order-detail.html",controller:"userOrderDetailCtrl",authn:!0}).state("user/wallet",{url:"/user/wallet",templateUrl:"template/mylvtuan/user/wallet/wallet.html",controller:"userwalletCtrl",authn:!0}).state("user/moneyin",{url:"/user/moneyin",templateUrl:"template/mylvtuan/user/wallet/moneyin.html",controller:"usermoneyinCtrl",authn:!0}).state("user/record",{url:"/user/record",templateUrl:"template/mylvtuan/user/wallet/record.html",controller:"userrecordCtrl",authn:!0}).state("user/moneyout",{url:"/user/moneyout",templateUrl:"template/mylvtuan/user/wallet/moneyout.html",authn:!0}).state("user/withdraw",{url:"/user/withdraw",templateUrl:"template/mylvtuan/user/wallet/withdraw.html",controller:"userwithdrawCtrl",authn:!0}).state("user/payall",{url:"/user/payall",templateUrl:"template/mylvtuan/user/wallet/payall.html",controller:"userpayallCtrl",authn:!0}).state("lawlecture",{url:"/lawlecture",templateUrl:"template/lecture/lawlecture.html",controller:"lawlectureCtrl"}).state("casescomm",{url:"/casescomm",templateUrl:"template/casescomm.html",controller:"casescommCtrl"}).state("lvtuanalliance",{url:"/lvtuanalliance",templateUrl:"template/lvtuanalliance.html",controller:"lvtuanallianceCtrl"}).state("lvtuanallianceview",{url:"/lvtuanallianceview/:id",templateUrl:"template/lvtuanalliance_view.html",controller:"lvtuanallianceviewCtrl"}).state("talent",{url:"/talent",templateUrl:"template/talent.html",controller:"talentCtrl"}).state("talentview",{url:"/talentview/:id",templateUrl:"template/talentview.html",controller:"talentviewCtrl"}).state("document/list",{url:"/document/list",templateUrl:"template/document/list.html",controller:"documentlistCtrl"}).state("document/download_list",{url:"/document/download_list/:id",templateUrl:"template/document/download_list.html",controller:"documentownloadlistCtrl"}).state("corporate",{url:"/corporate",templateUrl:"template/corporate/corporateservices.html",controller:"corporateservicesCtrl"}).state("corporate/list",{url:"/corporate/list/:id",templateUrl:"template/corporate/list.html",controller:"corporatelistCtrl"}).state("corporate/buynow",{url:"/corporate/buynow/:id",templateUrl:"template/corporate/buynow.html",controller:"corporatebuynowCtrl"}).state("pay",{url:"/pay/:id",templateUrl:"template/pay.html",controller:"payCtrl"}).state("citypicker",{url:"/citypicker",templateUrl:"template/citypicker.html",controller:"citypickerCtrl"}).state("error",{url:"/error",templateUrl:"template/error.html"}),$urlRouterProvider.otherwise("/index")});var authModule=angular.module("authModule",[]);authModule.constant("HOST",AppSettings.baseApiUrl).service("userService",userService).service("authService",authService);var httpModule=angular.module("httpModule",["authModule"]);httpModule.factory("httpWrapper",["$http","$rootScope",function($http,$rootScope){var httpRequest={};return httpRequest.get=function(url,successCallback){$http.get(url,{cache:!0,headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).success(successCallback?successCallback:function(data){}).error(function(data,status){layer.msg(status),console.info(JSON.stringify(data))})},httpRequest.request=function(url,method,data,successCallback,failureCallback){$http({method:method,url:url,data:data,cache:!0,headers:{"Content-Type":"application/json",Authorization:"bearer "+$rootScope.token}}).then(successCallback?successCallback:function(response){},failureCallback?failureCallback:function(response){console.info(JSON.stringify(response.data)),console.info(JSON.stringify(response.status))})},httpRequest}]),httpModule.factory("APIInterceptor",["$log","$q","$rootScope","authService","HOST",function($log,$q,$rootScope,authService,HOST){$log.debug("$log is here to show you that this is a regular factory with injection");var myInterceptor={request:function(config){if(config.url.indexOf(HOST)>-1){$rootScope.show();var token=authService.getToken();if(token&&(config.headers.Authorization="Bearer "+token),config.headers.Accept="application/json",config.cache=!0,config.url.indexOf(HOST+"/center")>-1||config.url.indexOf(HOST+"/group")>-1||config.url.indexOf(HOST+"/microblog")>-1){var canceller=$q.defer();authService.isAuthed()?(config.url.indexOf(HOST+"/group")>-1||config.url.indexOf(HOST+"/microblog")>-1)&&(user=authService.getUser(),user.is_verified_lawyer||$rootScope.$broadcast("unauthorized")):($rootScope.$broadcast("unauthenticated"),config.timeout=canceller.promise,canceller.resolve())}}return config},requestError:function(rejection){return canRecover(rejection)?responseOrNewPromise:$q.reject(rejection)},response:function(response){return response.config.url.indexOf(HOST)>-1&&$rootScope.hide(),response},responseError:function(response){switch(response.status){case 401:case 403:$rootScope.$broadcast("unauthorized");break;case 400:angular.forEach(response.data.error_messages,function(val,key){angular.isArray(val)?layer.show(val.join(", ")):layer.show(val)});break;case 405:layer.show("提交数据的方法错误");break;case 503:case 500:layer.show("暂时无法处理您的请求，请稍后再试。")}return console.info(response),$rootScope.hide(),$q.reject(response)}};return myInterceptor}]),httpModule.constant("HOST",AppSettings.baseApiUrl);var listModule=angular.module("listModule",["ionic","ngSanitize","ngFileUpload","httpModule"]);listModule.factory("listHelper",["$http","$rootScope","httpWrapper",function($http,$rootScope,httpWrapper){var listHelper={};return listHelper.bootstrap=function(url,$scope){var page=1,rows_per_page=5;$scope.rows_per_page&&(rows_per_page=$scope.rows_per_page),$scope.moredata=!0,$scope.items=[],$scope.doRefresh=function(){page=1,$scope.items=[],$scope.loadMore(),$scope.$broadcast("scroll.refreshComplete")},$scope.loadMore=function(){var urls=url.split("?"),params="rows_per_page="+rows_per_page+"&page="+page;2==urls.length&&(url=urls[0],params=urls[1]+"&"+params),httpWrapper.get("http://"+$rootScope.hostName+url+"?"+params,function(data){data&&data.data&&data.data.length?($scope.items=$scope.items.concat(data.data),console.info($scope.items),data.data.length<rows_per_page?$scope.moredata=!1:$scope.moredata=!0):(1==page&&layer.show("暂无数据！"),$scope.moredata=!1),page++,$scope.$broadcast("scroll.infiniteScrollComplete")})}},listHelper}]);var wxModule=angular.module("wxModule",[]);wxModule.service("wxService",wxService);